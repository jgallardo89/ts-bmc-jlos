####################################################################
###############@Clase: AcountBoxDao.java ###########################
####################################################################
SPR_TIPOMONEDA 		 = 	{call spr_TipoMoneda()}

SPR_TIPOIVA 		 =	{call spr_TipoIVA()}

SPR_TIPOCANAL		 =	{call spr_TipoCanal()}

SPR_RELACIONCTABUZON = {call spr_RelacionCtaBuzon(?,?)}

SPR_U_MT940VAL_ACT_CUENTACHEQUES = {call spr_u_MT940Val_Act_CuentaCheques(?,?)}

SPI_RELACIONCTABUZON = {call spi_RelacionCtaBuzon(?,?,?,?,?,?,?,?,?,?,?,?,?)}

SPU_RELACIONCTABUZON = {call spu_RelacionCtaBuzon(?,?,?,?,?,?,?,?,?,?,?,?,?)}

SPD_RELACIONCTABUZON = {call spd_RelacionCtaBuzon(?)}

SPR_RELACIONCTABUZONID = {call spr_RelacionCtaBuzonId(?)}

################################################################################################################
## QUERY PARA OBTENER LAS LIGAS ASOCIADAS A UN USUARIO - PAIS (PARAM1, PARAM2 = CD_USUARIO, PARAM3 = CD_PAIS) ##
################################################################################################################
ArmarMenu = SELECT T017.NU_ORDEN ORD_SEC, T017.CD_SECCION, T017.NB_SECCION, NVL(T018.NU_ORDEN, 0) ORD_SUB, \
			NVL(T018.CD_SUBSECCION, 0) CD_SUBSECCION, NVL(T018.NB_SUBSECCION, T020.NB_LIGA) NB_SUBSECCION, \
			T020.NU_ORDEN ORD_LIG, T020.CD_LIGA, T020.CD_TP_LIGA, T020.NB_LIGA, T020.NB_RUTA_LIGA, \
			T020.TP_LIGA_PRIVADA, T020.TX_LIGA \
			FROM TGM020_LIGA T020 \
			INNER JOIN TGM017_SECCION T017 ON T020.CD_SECCION = T017.CD_SECCION \
			LEFT JOIN TGM018_SUBSECCION T018 ON T020.CD_SUBSECCION = T018.CD_SUBSECCION \
			WHERE (T020.TP_LIGA_PRIVADA = 0 \
			OR T020.CD_LIGA IN(SELECT L_G.CD_LIGA \
                   FROM TGM023_USUARIO USR \
                   INNER JOIN TGM025_USUARIO_GRU U_G ON USR.CD_USUARIO = U_G.CD_USUARIO \
                   INNER JOIN TGM022_LIGA_GRUPO L_G ON U_G.CD_GRUPO = L_G.CD_GRUPO \
                   WHERE USR.CD_USUARIO = ?) \
			OR T020.CD_LIGA IN(SELECT L_U.CD_LIGA \
                   FROM TGM024_LIGA_USUARI L_U \
                   INNER JOIN TGM023_USUARIO USR ON USR.CD_USUARIO = L_U.CD_USUARIO \
                   WHERE USR.CD_USUARIO = ?)) \
			AND (T020.CD_PAIS IS NULL OR T020.CD_PAIS = ?) \
			AND T020.CD_TP_LIGA <> 4 \
			ORDER BY ORD_SEC, ORD_SUB, ORD_LIG
			
################################################################################################################
################################################################################################################

####################################################################
###############@Clase: AltaDesbloqueoDao.java ######################
####################################################################
getUser =  SELECT *  FROM TGM023_USUARIO WHERE UPPER(cd_clave_usuario) = UPPER(?)

getUserXPais = SELECT * FROM TGM023_USUARIO USUARIO INNER JOIN  PAIS ON USUARIO.CD_PAIS = PAIS.CD_PAIS \
				WHERE UPPER(USUARIO.CD_CLAVE_USUARIO) = UPPER(?) AND UPPER(PAIS.NB_PAIS_CCR) = UPPER(?)

getDesbloq = SELECT * FROM TGM026_DESBLOQ_USR DESB WHERE DESB.CD_USUARIO = ?

SP_GM026_INS_DESBLOQ_USER = {CALL SP_GM026_INS_DESBLOQ_USER(?,?,?,?,?,?,?)}

updateDesbloq = UPDATE TGM026_DESBLOQ_USR DESB SET \
 				 	DESB.TX_RESPUESTA1 = ?, \
 				 	DESB.TX_RESPUESTA2 = ?, \
 				 	DESB.TX_RESPUESTA3 = ?  \
 				WHERE DESB.CD_USUARIO  = ?

####################################################################
###############@Clase: AutoDesbloqueoDao.java ######################
#################################################################### 				
updateFechaDesbloq = UPDATE TGM026_DESBLOQ_USR DESB SET \
 				  		DESB.TM_ULTIMO_DESBLOQ=SYSDATE \
 				  	 WHERE DESB.CD_USUARIO=?

resetLogAcountById = UPDATE TGM023_USUARIO SET CT_LOGEO_ERRONEO = 0 WHERE CD_USUARIO=?

####################################################################
###############@Clase: CatalogoCanalesDao.java #####################
####################################################################
SP_GM003_INS_CNL = {CALL SP_GM003_INS_CNL(?,?)}

SP_GM003_DEL_CNL = {CALL SP_GM003_DEL_CNL(?)}

SP_GM003_UPD_CNL = {CALL SP_GM003_UPD_CNL(?,?,?)}

SP_GM003_LST_CNL = SELECT * FROM TGM003_CANAL ORDER BY 1 DESC

####################################################################
###############@Clase: CteSwCanalesDao.java ########################
####################################################################
SPR_IDUSUARIO_X_NOMBREUSR = {CALL spr_IdUsuario_x_NombreUsr(?)}

SPI_MACUGFACT_CANAL = {CALL spi_MacugFact_Canal(?,?)}

SPD_MACUGFACT_CANAL = {CALL spd_MacugFact_Canal(?,?)}

SPU_MACUGFACT_CANAL = {CALL spu_MacugFact_Canal(?,?,?)}

SPR_MACUGFACT_CANAL = {CALL spr_MacugFact_Canal()}



###Carga el mensaje de aviso de titulo de pantalla 
#QUITO TEMPORALMENTE LA LEYENDA  
getAvisos = SELECT CD_AVISO, TX_AVISO, TO_CHAR(TM_ALTA,'dd-mm-YYYY hh24:mi') TM_ALTA_CHAR, TM_ALTA  FROM TGM015_AVISO ORDER BY TM_ALTA DESC

################################################

#####A###########################################
#Carga el catalogo de canales disponibles
selectChannels = select * from TGM003_CANAL where NB_CANAL = 'N/A' \
				 union \
				 select * from TGM003_CANAL where NB_CANAL <> 'N/A'
#################################################

selectServices = select * from TGM002_SERVICIO

################################################
#Carga el catalogo de paises disponibles
getCountries = select * from TGM006_PAIS
#################################################

################################################
#Carga el catalogo de paises disponibles en las ligas
getCountriesDistinct = select distinct(CD_PAIS) from TGM020_LIGA
#################################################

################################################
#Obtiene un pais por id
getCountriesById = select * from TGM006_PAIS where CD_PAIS = ?
#################################################

#################################################
#Carga el catalogo de Codigos BIC Euro
selectCodesBICEuro = select * from TGM012_BIC_EURO
#################################################

################################################
#Obtiene un grupo por ID
getGroupById = select nb_grupo from TGM016_GRUPO_USR where CD_GRUPO=?
#################################################

################################################
#Carga el catalogo de paises disponibles
getCoins = select * from TGM027_MONEDA
#################################################

#### verifica si el bic introducido existe ######
verifyBic  = 	select count(*) from TGM031_BIC_CLIENTE where NB_BIC_SW_CTE = ?
##################################################

### Inserta un nuevo codigo bic en el catalogo####
saveBic  = 	insert into TGM031_BIC_CLIENTE cte (NB_BIC_SW_CTE) values (?)
##################################################

#### Inserta nuevo branch ########################
saveBranch  = 	insert into TGM032_OFI_SW_CTE cte (CTE.NB_OFI_SW_CTE , CTE.CD_BIC_SW_CTE ) values (?,?)
##################################################

####Obtiene un registro Bic specifico ###########
getBic  = 	select * from TGM031_BIC_CLIENTE where NB_BIC_SW_CTE = ?
##################################################

###Obtiene un registro branch especifio #########
getBranch  = 	select * from TGM032_OFI_SW_CTE branch where BRANCH.CD_BIC_SW_CTE = ? and BRANCH.NB_OFI_SW_CTE = ?
##################################################

##Obtiene branch nulo ############################
getBranchNull  = 	select * from TGM032_OFI_SW_CTE branch where BRANCH.CD_BIC_SW_CTE = ? and BRANCH.NB_OFI_SW_CTE is null
##################################################

###Inserta un nuevo cliente #####################
saveRegister  = 	insert into TGM001_CLIENTE \
					(CD_REFERENCIA, CD_PAIS, CD_BIC_SW_CTE, cd_cte_latam, CD_BIC_EURO, nb_cliente, cd_acr_cliente, TM_ALTA, cd_activo) \
					values(?,?,?,?,?,?,?,sysdate,?)
##################################################

####Inserta Relacion clientes/servicios contratados#
saveRelClientServ = 	insert into TGM004_CTE_SERV \
						(CD_CLIENTE, CD_TP_SERVICIO, CD_OFI_SW_CTE, TM_ALTA, CD_TP_SRV_SWIFT) \
						values(?, ?, ?, sysdate,?)
##################################################

###Busca un registro de cliente especifico########
searchClient = 	select CLIENTE.CD_CLIENTE, CLIENTE.NB_CLIENTE, CLIENTE.CD_REFERENCIA, CLIENTE.CD_PAIS \
			    from TGM001_CLIENTE cliente \
			    where CLIENTE.NB_CLIENTE=? and CLIENTE.CD_REFERENCIA = ? and CLIENTE.CD_PAIS=?
##################################################

#### Inserta relacion cliente con canal ##########

saveRelCteCanal = 	insert into TGM005_CTE_CANAL   \
					(CD_CLIENTE, CD_TP_CANAL) \
					values(?,?)
##################################################

####Inserta relacion cliente con numero de cuenta#
saveRelCteCuenta = 	insert into TGM008_CUENTA 			\
					(CD_CUENTA, CD_CLIENTE,TM_ALTA) \
					values(?,?,sysdate)
##################################################

####Inserta Relacion clientes mexico #############
saveRelClientMx = 	INSERT INTO TGM035_MX_CONTRATO( \
					CD_CUENTA_CHEQUES, CD_MONEDA, CD_CONTRATO_SWIFT, \
					NB_EMPRESA, PC_IVA, TP_CLIENTE_AAA, \
					CD_CONTRATO_SICOCO, TP_ANUALIDAD, TP_MENSUALIDAD, \
					TP_ARCH_SICOCO_GEN) \
					VALUES (?,?,?,?,?,?,?,?,?,?)
##################################################	    

#Query para eliminar relacion cliente con servicio# 
deleteClientServ  = delete from TGM004_CTE_SERV where CD_CLIENTE = ? and CD_TP_SERVICIO = ?
##################################################

#Query consulta numero relacion cliente servicios# 
hasService  = select count(*) from TGM004_CTE_SERV srv where srv.CD_CLIENTE= ?
##################################################

#Query para eliminar relacion cliente con cuenta# 
deleteAcountClient = delete from TGM008_CUENTA where CD_CLIENTE = ? and CD_CUENTA = ?

deleteAcountClientID  = delete from TGM008_CUENTA where CD_CLIENTE = ?
##################################################

#Query para eliminar relacion cliente con cuenta# 
deleteRLCanal = delete from TGM005_CTE_CANAL where CD_CLIENTE = ?

#Query para eliminar relacion cliente mexico# 
deleteRLCteMX = delete from tGM028_rl_cte_mx where CD_CLIENTE = ?

#Obtiene el codigo bic y branch de un cliente#####
decodeBicBranch = 	select  SRV.CD_CLIENTE, BIC.NB_BIC_SW_CTE, BRANCH.NB_OFI_SW_CTE \
					from \
							TGM001_CLIENTE cliente, TGM004_CTE_SERV srv, TGM031_BIC_CLIENTE bic, TGM032_OFI_SW_CTE branch \
					where \
							 CLIENTE.CD_BIC_SW_CTE  = BIC.CD_BIC_SW_CTE and \
							 CLIENTE.CD_CLIENTE  = SRV.CD_CLIENTE and \
							 BRANCH.CD_OFI_SW_CTE = SRV.CD_OFI_SW_CTE   and \
							 CLIENTE.CD_BIC_SW_CTE = ? and SRV.CD_TP_SERVICIO = ?  and CLIENTE.CD_CLIENTE = ?
###################################################

###################################################
############ R E C A U D O S  #####################
###################################################

###Obtine la lista de clientes con recaudo ########
getTableServices_Se_Usara_Despues = SELECT																																\
       				CLIENTE.CD_CLIENTE, 																											\
       				CLIENTE.NB_CLIENTE,  																											\
       				CLIENTE.CD_PAIS,																												\
       				(SELECT TX_PAIS FROM TGM006_PAIS P WHERE P.CD_PAIS=CLIENTE.CD_PAIS) NB_PAIS,													\
       				CLIENTE.CD_ACR_CLIENTE,																											\
       				CLIENTE.CD_REFERENCIA,																											\
       				(SELECT P.NB_BIC_SW_CTE || O.NB_OFI_SW_CTE AS A FROM TGM031_BIC_CLIENTE P, TGM032_OFI_SW_CTE O WHERE P.CD_BIC_SW_CTE   =   CLIENTE.CD_BIC_SW_CTE AND O.CD_BIC_SW_CTE=P.CD_BIC_SW_CTE AND O.CD_OFI_SW_CTE=SERVICIO.CD_OFI_SW_CTE ) BIC ,\
       				CLIENTE.CD_CTE_LATAM,																											\
       				CLIENTE.CD_BIC_SW_CTE_ENV,																										\
       				CLIENTE.CD_BIC_EURO,																											\																											\
       				SERVICIO.CD_TP_SERVICIO,																										\
       				SERVICIO.CD_OFI_SW_CTE,																											\
       				SERVICIO.CD_TP_SRV_SWIFT,																										\
       				(SELECT CUENTA.CD_CUENTA  FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) CD_CUENTA,					\
       				(SELECT CUENTA.NU_OFICINA FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) NU_OFICINA,					\
       				(SELECT CUENTA.CD_BIC_CTA_ENV FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) CD_BIC_CTA_ENV,			\
       				(SELECT CUENTA.CD_OFI_CTA_ENV FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) CD_OFI_CTA_ENV,			\
       				(SELECT MX.CD_MONEDA FROM TGM008_CUENTA CUENTA, TGM035_MX_CONTRATO MX WHERE CUENTA.CD_CLIENTE=CLIENTE.CD_CLIENTE AND CUENTA.CD_CUENTA = MX.CD_CUENTA_CHEQUES) CD_MONEDA, 					\
       				(SELECT MX.CD_CONTRATO_SWIFT  FROM TGM008_CUENTA CUENTA, TGM035_MX_CONTRATO MX WHERE CUENTA.CD_CLIENTE=CLIENTE.CD_CLIENTE AND CUENTA.CD_CUENTA = MX.CD_CUENTA_CHEQUES) CD_CONTRATO_SWIFT,	\
       				(SELECT MX.NB_EMPRESA  FROM TGM008_CUENTA CUENTA, TGM035_MX_CONTRATO MX WHERE CUENTA.CD_CLIENTE=CLIENTE.CD_CLIENTE AND CUENTA.CD_CUENTA = MX.CD_CUENTA_CHEQUES) NB_EMPRESA,					\
       				(SELECT MX.PC_IVA  FROM TGM008_CUENTA CUENTA, TGM035_MX_CONTRATO MX WHERE CUENTA.CD_CLIENTE=CLIENTE.CD_CLIENTE AND CUENTA.CD_CUENTA = MX.CD_CUENTA_CHEQUES) PC_IVA,							\
       				(SELECT MX.TP_CLIENTE_AAA FROM TGM008_CUENTA CUENTA, TGM035_MX_CONTRATO MX WHERE CUENTA.CD_CLIENTE=CLIENTE.CD_CLIENTE AND CUENTA.CD_CUENTA = MX.CD_CUENTA_CHEQUES) TP_CLIENTE_AAA,			\
       				(SELECT MX.CD_CONTRATO_SICOCO FROM TGM008_CUENTA CUENTA, TGM035_MX_CONTRATO MX WHERE CUENTA.CD_CLIENTE=CLIENTE.CD_CLIENTE AND CUENTA.CD_CUENTA = MX.CD_CUENTA_CHEQUES) CD_CONTRATO_SICOCO,	\
       				(SELECT MX.TP_ANUALIDAD FROM TGM008_CUENTA CUENTA, TGM035_MX_CONTRATO MX WHERE CUENTA.CD_CLIENTE=CLIENTE.CD_CLIENTE AND CUENTA.CD_CUENTA = MX.CD_CUENTA_CHEQUES) TP_ANUALIDAD,				\
       				(SELECT MX.TP_MENSUALIDAD FROM TGM008_CUENTA CUENTA, TGM035_MX_CONTRATO MX WHERE CUENTA.CD_CLIENTE=CLIENTE.CD_CLIENTE AND CUENTA.CD_CUENTA = MX.CD_CUENTA_CHEQUES) TP_MENSUALIDAD,			\
			       (SELECT MX.TP_ARCH_SICOCO_GEN FROM TGM008_CUENTA CUENTA, TGM035_MX_CONTRATO MX WHERE CUENTA.CD_CLIENTE=CLIENTE.CD_CLIENTE AND CUENTA.CD_CUENTA = MX.CD_CUENTA_CHEQUES) TP_ARCH_SICOCO_GEN,	\
			       CLIENTE.CD_ACTIVO,																												\
       				CLIENTE.TM_ALTA, \
       				CLIENTE.CD_OFI_SW_CTE_ENV																										\
				FROM																																\
					TGM001_CLIENTE CLIENTE,																											\
			        TGM004_CTE_SERV SERVICIO																										\
				WHERE																																\
        			CLIENTE.CD_CLIENTE      =   SERVICIO.CD_CLIENTE    AND																			\
        			SERVICIO.CD_TP_SERVICIO =   ? AND \
        			CLIENTE.CD_ACTIVO = 1


getTableServices = SELECT \
                       CLIENTE.CD_CLIENTE, \
                       CLIENTE.NB_CLIENTE, \
                       CLIENTE.CD_PAIS,   \
                       (SELECT TX_PAIS FROM TGM006_PAIS P WHERE P.CD_PAIS=CLIENTE.CD_PAIS) NB_PAIS, \
                       CLIENTE.CD_ACR_CLIENTE,                                                               \
                       CLIENTE.CD_REFERENCIA,                                                                 \
                       (SELECT P.NB_BIC_SW_CTE || O.NB_OFI_SW_CTE AS A FROM TGM031_BIC_CLIENTE P, TGM032_OFI_SW_CTE O WHERE P.CD_BIC_SW_CTE   =   CLIENTE.CD_BIC_SW_CTE AND O.CD_BIC_SW_CTE=P.CD_BIC_SW_CTE AND O.CD_OFI_SW_CTE=SERVICIO.CD_OFI_SW_CTE ) BIC ,\
                       CLIENTE.CD_CTE_LATAM,                                                                                                            \
                       CLIENTE.CD_BIC_SW_CTE_ENV,                                                                                                       \
                       CLIENTE.CD_BIC_EURO,                                                                                                              \
                       SERVICIO.CD_TP_SERVICIO,                                                                                                       \
                       SERVICIO.CD_OFI_SW_CTE,                                                                                                         \
                       SERVICIO.CD_TP_SRV_SWIFT,                                                                                                        \
                       (SELECT CUENTA.CD_CUENTA  FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) CD_CUENTA,              \
                       (SELECT CUENTA.NU_OFICINA FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) NU_OFICINA,              \
                       (SELECT CUENTA.CD_BIC_CTA_ENV FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) CD_BIC_CTA_ENV,       \
                       (SELECT CUENTA.CD_OFI_CTA_ENV FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) CD_OFI_CTA_ENV,        \
                       (select 1*1 from dual) CD_MONEDA,                     \
                       (select 1*1 from dual) CD_CONTRATO_SWIFT,    \
                       (select 1*1 from dual) NB_EMPRESA,            \
                       (select 1*1 from dual) PC_IVA,                 \
                       (select 1*1 from dual) TP_CLIENTE_AAA,          \
                       (select 1*1 from dual) CD_CONTRATO_SICOCO,    \
                       (select 1*1 from dual) TP_ANUALIDAD,           \
                       (select 1*1 from dual) TP_MENSUALIDAD,          \
                       (select 1*1 from dual) TP_ARCH_SICOCO_GEN,    \
                       CLIENTE.CD_ACTIVO,                             \
                       CLIENTE.TM_ALTA, \
                       CLIENTE.CD_OFI_SW_CTE_ENV \
                FROM                              \
                    TGM001_CLIENTE CLIENTE, \
                    TGM004_CTE_SERV SERVICIO \
                WHERE                                 \
                    CLIENTE.CD_CLIENTE      =   SERVICIO.CD_CLIENTE    AND \
                    SERVICIO.CD_TP_SERVICIO =   ? AND \
                    CLIENTE.CD_ACTIVO = 1

        			
#################################################

getTableServicesPais = SELECT \
                       CLIENTE.CD_CLIENTE, \
                       CLIENTE.NB_CLIENTE, \
                       CLIENTE.CD_PAIS,   \
                       (SELECT TX_PAIS FROM TGM006_PAIS P WHERE P.CD_PAIS=CLIENTE.CD_PAIS) NB_PAIS, \
                       CLIENTE.CD_ACR_CLIENTE,                                                               \
                       CLIENTE.CD_REFERENCIA,                                                                 \
                       (SELECT P.NB_BIC_SW_CTE || O.NB_OFI_SW_CTE AS A FROM TGM031_BIC_CLIENTE P, TGM032_OFI_SW_CTE O WHERE P.CD_BIC_SW_CTE   =   CLIENTE.CD_BIC_SW_CTE AND O.CD_BIC_SW_CTE=P.CD_BIC_SW_CTE AND O.CD_OFI_SW_CTE=SERVICIO.CD_OFI_SW_CTE ) BIC ,\
                       CLIENTE.CD_CTE_LATAM,                                                                                                            \
                       CLIENTE.CD_BIC_SW_CTE_ENV,                                                                                                       \
                       CLIENTE.CD_BIC_EURO,                                                                                                              \
                       SERVICIO.CD_TP_SERVICIO,                                                                                                       \
                       SERVICIO.CD_OFI_SW_CTE,                                                                                                         \
                       SERVICIO.CD_TP_SRV_SWIFT,                                                                                                        \
                       (SELECT CUENTA.CD_CUENTA  FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) CD_CUENTA,              \
                       (SELECT CUENTA.NU_OFICINA FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) NU_OFICINA,              \
                       (SELECT CUENTA.CD_BIC_CTA_ENV FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) CD_BIC_CTA_ENV,       \
                       (SELECT CUENTA.CD_OFI_CTA_ENV FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) CD_OFI_CTA_ENV,        \
                       (select 1*1 from dual) CD_MONEDA,                     \
                       (select 1*1 from dual) CD_CONTRATO_SWIFT,    \
                       (select 1*1 from dual) NB_EMPRESA,            \
                       (select 1*1 from dual) PC_IVA,                 \
                       (select 1*1 from dual) TP_CLIENTE_AAA,          \
                       (select 1*1 from dual) CD_CONTRATO_SICOCO,    \
                       (select 1*1 from dual) TP_ANUALIDAD,           \
                       (select 1*1 from dual) TP_MENSUALIDAD,          \
                       (select 1*1 from dual) TP_ARCH_SICOCO_GEN,    \
                       CLIENTE.CD_ACTIVO,                             \
                       CLIENTE.TM_ALTA, \
                       CLIENTE.CD_OFI_SW_CTE_ENV \
                FROM                              \
                    TGM001_CLIENTE CLIENTE, \
                    TGM004_CTE_SERV SERVICIO \
                WHERE                                 \
                    CLIENTE.CD_CLIENTE      =   SERVICIO.CD_CLIENTE    AND \
                    SERVICIO.CD_TP_SERVICIO =   ? AND \
                    CLIENTE.CD_ACTIVO = 1 AND \
                    CLIENTE.CD_PAIS = ?



#################################################


###Obtine la lista de clientes con SERVICIO PAGOS ########
getTableServicesPay = SELECT																																\
       				CLIENTE.CD_CLIENTE, 																											\
       				CLIENTE.NB_CLIENTE,  																											\
       				CLIENTE.CD_PAIS,																												\
       				(SELECT TX_PAIS FROM TGM006_PAIS P WHERE P.CD_PAIS=CLIENTE.CD_PAIS) NB_PAIS,													\
       				CLIENTE.CD_ACR_CLIENTE,																											\
       				CLIENTE.CD_REFERENCIA,																											\
       				(SELECT P.NB_BIC_SW_CTE || O.NB_OFI_SW_CTE AS A FROM TGM031_BIC_CLIENTE P, TGM032_OFI_SW_CTE O WHERE P.CD_BIC_SW_CTE   =   CLIENTE.CD_BIC_SW_CTE AND O.CD_BIC_SW_CTE=P.CD_BIC_SW_CTE AND O.CD_OFI_SW_CTE=SERVICIO.CD_OFI_SW_CTE) BIC ,\
       				CLIENTE.CD_CTE_LATAM,																											\
       				CLIENTE.CD_BIC_SW_CTE_ENV,																										\
       				CLIENTE.CD_BIC_EURO,																											\
       				SERVICIO.CD_TP_SERVICIO,																										\
       				SERVICIO.CD_OFI_SW_CTE,																											\
       				SERVICIO.CD_TP_SRV_SWIFT,																										\
       				(SELECT CUENTA.CD_CUENTA  FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) CD_CUENTA,					\
       				(SELECT CUENTA.NU_OFICINA FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) NU_OFICINA,					\
       				(SELECT CUENTA.CD_BIC_CTA_ENV FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) CD_BIC_CTA_ENV,			\
       				(SELECT CUENTA.CD_OFI_CTA_ENV FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) CD_OFI_CTA_ENV,			\
       				(SELECT MX.CD_MONEDA FROM TGM008_CUENTA CUENTA, TGM035_MX_CONTRATO MX WHERE CUENTA.CD_CLIENTE=CLIENTE.CD_CLIENTE AND CUENTA.CD_CUENTA = MX.CD_CUENTA_CHEQUES) CD_MONEDA, 					\
       				(SELECT MX.CD_CONTRATO_SWIFT  FROM TGM008_CUENTA CUENTA, TGM035_MX_CONTRATO MX WHERE CUENTA.CD_CLIENTE=CLIENTE.CD_CLIENTE AND CUENTA.CD_CUENTA = MX.CD_CUENTA_CHEQUES) CD_CONTRATO_SWIFT,	\
       				(SELECT MX.NB_EMPRESA  FROM TGM008_CUENTA CUENTA, TGM035_MX_CONTRATO MX WHERE CUENTA.CD_CLIENTE=CLIENTE.CD_CLIENTE AND CUENTA.CD_CUENTA = MX.CD_CUENTA_CHEQUES) NB_EMPRESA,					\
       				(SELECT MX.PC_IVA  FROM TGM008_CUENTA CUENTA, TGM035_MX_CONTRATO MX WHERE CUENTA.CD_CLIENTE=CLIENTE.CD_CLIENTE AND CUENTA.CD_CUENTA = MX.CD_CUENTA_CHEQUES) PC_IVA,							\
       				(SELECT MX.TP_CLIENTE_AAA FROM TGM008_CUENTA CUENTA, TGM035_MX_CONTRATO MX WHERE CUENTA.CD_CLIENTE=CLIENTE.CD_CLIENTE AND CUENTA.CD_CUENTA = MX.CD_CUENTA_CHEQUES) TP_CLIENTE_AAA,			\
       				(SELECT MX.CD_CONTRATO_SICOCO FROM TGM008_CUENTA CUENTA, TGM035_MX_CONTRATO MX WHERE CUENTA.CD_CLIENTE=CLIENTE.CD_CLIENTE AND CUENTA.CD_CUENTA = MX.CD_CUENTA_CHEQUES) CD_CONTRATO_SICOCO,	\
       				(SELECT MX.TP_ANUALIDAD FROM TGM008_CUENTA CUENTA, TGM035_MX_CONTRATO MX WHERE CUENTA.CD_CLIENTE=CLIENTE.CD_CLIENTE AND CUENTA.CD_CUENTA = MX.CD_CUENTA_CHEQUES) TP_ANUALIDAD,				\
       				(SELECT MX.TP_MENSUALIDAD FROM TGM008_CUENTA CUENTA, TGM035_MX_CONTRATO MX WHERE CUENTA.CD_CLIENTE=CLIENTE.CD_CLIENTE AND CUENTA.CD_CUENTA = MX.CD_CUENTA_CHEQUES) TP_MENSUALIDAD,			\
			       (SELECT MX.TP_ARCH_SICOCO_GEN FROM TGM008_CUENTA CUENTA, TGM035_MX_CONTRATO MX WHERE CUENTA.CD_CLIENTE=CLIENTE.CD_CLIENTE AND CUENTA.CD_CUENTA = MX.CD_CUENTA_CHEQUES) TP_ARCH_SICOCO_GEN,	\
			       CLIENTE.CD_ACTIVO,																												\
       				CLIENTE.TM_ALTA, \
       				CLIENTE.CD_OFI_SW_CTE_ENV, \
       				 CANAL.CD_TP_CANAL																										\
				FROM																																\
					TGM001_CLIENTE CLIENTE,																											\
			        TGM004_CTE_SERV SERVICIO, \
			        TGM005_CTE_CANAL CANAL																										\
				WHERE																																\
        			CLIENTE.CD_CLIENTE      =   SERVICIO.CD_CLIENTE    AND																			\
        			SERVICIO.CD_TP_SERVICIO =   ? AND \
        			CLIENTE.CD_ACTIVO = 1 \
        			 AND CANAL.CD_CLIENTE = CLIENTE.CD_CLIENTE \
                    AND CANAL.CD_CLIENTE = SERVICIO.CD_CLIENTE ORDER BY TM_ALTA DESC
        			
#################################################

###Obtine la lista de clientes con SERVICIO RELAY ########
#getTableCRelay = SELECT																																\
#       				CLIENTE.CD_CLIENTE, 																											\
#       				CLIENTE.NB_CLIENTE,  																											\
#       				CLIENTE.CD_PAIS,																												\
#       				(SELECT TX_PAIS FROM TGM006_PAIS P WHERE P.CD_PAIS=CLIENTE.CD_PAIS) NB_PAIS,													\
#       				CLIENTE.CD_ACR_CLIENTE,																											\
#       				CLIENTE.CD_REFERENCIA,																											\
#       				(SELECT P.NB_BIC_SW_CTE || O.NB_OFI_SW_CTE AS A FROM TGM031_BIC_CLIENTE P, TGM032_OFI_SW_CTE O WHERE P.CD_BIC_SW_CTE   =   CLIENTE.CD_BIC_SW_CTE AND O.CD_BIC_SW_CTE=P.CD_BIC_SW_CTE AND O.CD_OFI_SW_CTE=SERVICIO.CD_OFI_SW_CTE ) BIC ,\
#       				CLIENTE.CD_CTE_LATAM,																											\
#       				CLIENTE.CD_BIC_SW_CTE_ENV,																										\
#       				CLIENTE.CD_BIC_EURO,																											\																											\
#       				SERVICIO.CD_TP_SERVICIO,																										\
#       				SERVICIO.CD_OFI_SW_CTE,																											\
#       				SERVICIO.CD_TP_SRV_SWIFT,																										\
#       				(SELECT CUENTA.CD_CUENTA  FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) CD_CUENTA,					\
#       				(SELECT CUENTA.NU_OFICINA FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) NU_OFICINA,					\
#       				(SELECT CUENTA.CD_BIC_CTA_ENV FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) CD_BIC_CTA_ENV,			\
#       				(SELECT CUENTA.CD_OFI_CTA_ENV FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) CD_OFI_CTA_ENV,			\
#       				--(SELECT MX.CD_MONEDA  FROM TGM035_MX_CONTRATO MX WHERE MX.CD_CUENTA_CHEQUES=CLIENTE.CD_REFERENCIA) CD_MONEDA,					\
#       				--(SELECT MX.CD_CONTRATO_SWIFT  FROM TGM035_MX_CONTRATO MX WHERE MX.CD_CUENTA_CHEQUES=CLIENTE.CD_REFERENCIA) CD_CONTRATO_SWIFT,	\
#       				--(SELECT MX.NB_EMPRESA  FROM TGM035_MX_CONTRATO MX WHERE MX.CD_CUENTA_CHEQUES=CLIENTE.CD_REFERENCIA) NB_EMPRESA,					\
#       				--(SELECT MX.PC_IVA  FROM TGM035_MX_CONTRATO MX WHERE MX.CD_CUENTA_CHEQUES=CLIENTE.CD_REFERENCIA) PC_IVA,							\
#       				--(SELECT MX.TP_CLIENTE_AAA  FROM TGM035_MX_CONTRATO MX WHERE MX.CD_CUENTA_CHEQUES=CLIENTE.CD_REFERENCIA) TP_CLIENTE_AAA,			\
#       				--(SELECT MX.CD_CONTRATO_SICOCO  FROM TGM035_MX_CONTRATO MX WHERE MX.CD_CUENTA_CHEQUES=CLIENTE.CD_REFERENCIA) CD_CONTRATO_SICOCO,	\
#       				--(SELECT MX.TP_ANUALIDAD  FROM TGM035_MX_CONTRATO MX WHERE MX.CD_CUENTA_CHEQUES=CLIENTE.CD_REFERENCIA) TP_ANUALIDAD,				\
#       				--(SELECT MX.TP_MENSUALIDAD  FROM TGM035_MX_CONTRATO MX WHERE MX.CD_CUENTA_CHEQUES=CLIENTE.CD_REFERENCIA) TP_MENSUALIDAD,			\
#			       	--(SELECT MX.TP_ARCH_SICOCO_GEN  FROM TGM035_MX_CONTRATO MX WHERE MX.CD_CUENTA_CHEQUES=CLIENTE.CD_REFERENCIA) TP_ARCH_SICOCO_GEN,	\
#			        RELAY.CD_CTA_RELAY,																												\
#                   	RELAY.NB_BIC_RELAY,																												\
#			       CLIENTE.CD_ACTIVO,																												\
#       				CLIENTE.TM_ALTA																													\
#				FROM																																\
#					TGM001_CLIENTE CLIENTE,																											\
#			        TGM004_CTE_SERV SERVICIO,																										\
#			         TGM030_CTA_RELAY RELAY 																										\
#				WHERE																																\
#        			CLIENTE.CD_CLIENTE      =   SERVICIO.CD_CLIENTE    AND																			\
#       			  RELAY.CD_CLIENTE        =   CLIENTE.CD_CLIENTE      AND																		\
#        			SERVICIO.CD_TP_SERVICIO =   ? AND \
#        			CLIENTE.CD_ACTIVO = 1 \
#        			ORDER BY TM_ALTA DESC
        			
#################################################


#################################################

###Obtine la lista de clientes con SERVICIO RELAY ########
getTableCRelay = SELECT \
       				CLIENTE.CD_CLIENTE, \
       				CLIENTE.NB_CLIENTE, \
       				CLIENTE.CD_PAIS, \
       				(SELECT TX_PAIS FROM TGM006_PAIS P WHERE P.CD_PAIS=CLIENTE.CD_PAIS) NB_PAIS, \
       				CLIENTE.CD_ACR_CLIENTE,	\
       				CLIENTE.CD_REFERENCIA,	\
       				(SELECT P.NB_BIC_SW_CTE || O.NB_OFI_SW_CTE AS A FROM TGM031_BIC_CLIENTE P, TGM032_OFI_SW_CTE O WHERE P.CD_BIC_SW_CTE   =   CLIENTE.CD_BIC_SW_CTE AND O.CD_BIC_SW_CTE=P.CD_BIC_SW_CTE AND O.CD_OFI_SW_CTE=SERVICIO.CD_OFI_SW_CTE ) BIC ,\
       				CLIENTE.CD_CTE_LATAM, \
       				CLIENTE.CD_BIC_SW_CTE_ENV, \
       				CLIENTE.CD_BIC_EURO, \
       				SERVICIO.CD_TP_SERVICIO, \
       				SERVICIO.CD_OFI_SW_CTE,	\
       				SERVICIO.CD_TP_SRV_SWIFT,\
       				(SELECT CUENTA.CD_CUENTA  FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) CD_CUENTA, \
       				(SELECT CUENTA.NU_OFICINA FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) NU_OFICINA, \
       				(SELECT CUENTA.CD_BIC_CTA_ENV FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) CD_BIC_CTA_ENV, \
       				(SELECT CUENTA.CD_OFI_CTA_ENV FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) CD_OFI_CTA_ENV, RELAY.CD_CTA_RELAY, \
                   	RELAY.NB_BIC_RELAY,	\
			       CLIENTE.CD_ACTIVO, \
       				CLIENTE.TM_ALTA	 \
				FROM \
					TGM001_CLIENTE CLIENTE, \
			        TGM004_CTE_SERV SERVICIO, \
			         TGM030_CTA_RELAY RELAY \
				WHERE \
        			CLIENTE.CD_CLIENTE      =   SERVICIO.CD_CLIENTE    AND \
       			  RELAY.CD_CLIENTE        =   CLIENTE.CD_CLIENTE      AND \
        			SERVICIO.CD_TP_SERVICIO =   ? AND \
        			CLIENTE.CD_ACTIVO = 1 \
        			ORDER BY TM_ALTA DESC
        			
#################################################

###Obtine la lista de clientes con SERVICIO RELAY POR PAIS########
getTableCRelayPais = SELECT \
       				CLIENTE.CD_CLIENTE, \
       				CLIENTE.NB_CLIENTE, \
       				CLIENTE.CD_PAIS, \
       				(SELECT TX_PAIS FROM TGM006_PAIS P WHERE P.CD_PAIS=CLIENTE.CD_PAIS) NB_PAIS, \
       				CLIENTE.CD_ACR_CLIENTE,	\
       				CLIENTE.CD_REFERENCIA,	\
       				(SELECT P.NB_BIC_SW_CTE || O.NB_OFI_SW_CTE AS A FROM TGM031_BIC_CLIENTE P, TGM032_OFI_SW_CTE O WHERE P.CD_BIC_SW_CTE   =   CLIENTE.CD_BIC_SW_CTE AND O.CD_BIC_SW_CTE=P.CD_BIC_SW_CTE AND O.CD_OFI_SW_CTE=SERVICIO.CD_OFI_SW_CTE ) BIC ,\
       				CLIENTE.CD_CTE_LATAM, \
       				CLIENTE.CD_BIC_SW_CTE_ENV, \
       				CLIENTE.CD_BIC_EURO, \
       				SERVICIO.CD_TP_SERVICIO, \
       				SERVICIO.CD_OFI_SW_CTE,	\
       				SERVICIO.CD_TP_SRV_SWIFT,\
       				(SELECT CUENTA.CD_CUENTA  FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) CD_CUENTA, \
       				(SELECT CUENTA.NU_OFICINA FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) NU_OFICINA, \
       				(SELECT CUENTA.CD_BIC_CTA_ENV FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) CD_BIC_CTA_ENV, \
       				(SELECT CUENTA.CD_OFI_CTA_ENV FROM TGM008_CUENTA CUENTA WHERE CUENTA.CD_CLIENTE=SERVICIO.CD_CLIENTE ) CD_OFI_CTA_ENV, RELAY.CD_CTA_RELAY, \
                   	RELAY.NB_BIC_RELAY,	\
			       CLIENTE.CD_ACTIVO, \
       				CLIENTE.TM_ALTA	 \
				FROM \
					TGM001_CLIENTE CLIENTE, \
			        TGM004_CTE_SERV SERVICIO, \
			         TGM030_CTA_RELAY RELAY \
				WHERE \
        			CLIENTE.CD_CLIENTE      =   SERVICIO.CD_CLIENTE    AND \
       			  RELAY.CD_CLIENTE        =   CLIENTE.CD_CLIENTE      AND \
        			SERVICIO.CD_TP_SERVICIO =   ? AND \
        			CLIENTE.CD_ACTIVO = 1 AND \
                    CLIENTE.CD_PAIS = ? \
        			ORDER BY TM_ALTA DESC



#################################################



#Obtiene un cliente con recaudo de alta con cuenta asiganada#
getClient  = 	select * \
				from TGM001_CLIENTE cte, TGM004_CTE_SERV cteserv,   \
					 TGM005_CTE_CANAL  ctecnl, TGM008_CUENTA  cta    \
	           	where cte.CD_CLIENTE = cteserv.CD_CLIENTE AND  \
                      cte.CD_CLIENTE = ctecnl.CD_CLIENTE AND   \
                      cte.CD_CLIENTE = cta.CD_CLIENTE AND 	 \
                      cteserv.CD_CLIENTE = cte.CD_CLIENTE AND  \
                      cteserv.CD_CLIENTE = cta.CD_CLIENTE AND  \
                      ctecnl.CD_CLIENTE = cta.CD_CLIENTE AND   \
		  			  cteserv.CD_TP_SERVICIO = ?  AND cte.CD_CLIENTE = ?
##################################################

#Obtiene un cliente con recaudo de alta sin cuenta asiganada#
getClientSC  = 	select * \
				from TGM001_CLIENTE cte, TGM004_CTE_SERV cteserv,   \
					 TGM005_CTE_CANAL  ctecnl					     \
	           	where cte.CD_CLIENTE = cteserv.CD_CLIENTE AND  \
                      cte.CD_CLIENTE = ctecnl.CD_CLIENTE AND   \
                      cteserv.CD_CLIENTE = ctecnl.CD_CLIENTE AND  \
		  			  cteserv.CD_TP_SERVICIO = ?  AND cte.CD_CLIENTE = ?
##################################################

#Query para obtener un cliente MEXICO recaudo de alta con cuenta asiganada
getClientMX  = 	select * \
				from TGM001_CLIENTE cte, TGM004_CTE_SERV cteserv, \
				TGM005_CTE_CANAL  ctecnl, TGM008_CUENTA  cta, \
				TGM028_RL_CTE_MX ctemx \
				where cte.CD_CLIENTE = cteserv.CD_CLIENTE AND \
				      cte.CD_CLIENTE = ctecnl.CD_CLIENTE AND  \
				      cte.CD_CLIENTE = cta.CD_CLIENTE AND \
				      cte.CD_CLIENTE = ctemx.CD_CLIENTE AND \
				      cteserv.CD_CLIENTE = ctecnl.CD_CLIENTE AND \
				      cteserv.CD_CLIENTE = cta.CD_CLIENTE AND \
				      cteserv.CD_CLIENTE = ctemx.CD_CLIENTE AND \
				      ctecnl.CD_CLIENTE = cta.CD_CLIENTE AND \
				      ctecnl.CD_CLIENTE = ctemx.CD_CLIENTE AND \
				      cta.CD_CLIENTE = ctemx.CD_CLIENTE AND \
				      cteserv.CD_TP_SERVICIO = ? AND \
				      cte.CD_CLIENTE = ?
##################################################

##Query para obtener un cliente MEXICO recaudo SIN cuenta asiganada#
getClientMXSC  = select * \
				from TGM001_CLIENTE cte, TGM004_CTE_SERV cteserv, \
					 TGM005_CTE_CANAL  ctecnl,TGM028_RL_CTE_MX ctemx \
				where cte.CD_CLIENTE = cteserv.CD_CLIENTE AND \
				      cte.CD_CLIENTE = ctecnl.CD_CLIENTE AND	\
				      cte.CD_CLIENTE = ctemx.CD_CLIENTE AND	\
				      cteserv.CD_CLIENTE = ctecnl.CD_CLIENTE AND \
				      cteserv.CD_CLIENTE = ctemx.CD_CLIENTE AND \
				      ctecnl.CD_CLIENTE = ctemx.CD_CLIENTE AND \
					  cteserv.CD_TP_SERVICIO = ?  AND \
					  cte.CD_CLIENTE = ?
##################################################

###Actualiza tabla de relacion cliente mx con moneda y aaa##
updatRelClientMx  = UPDATE TGM035_MX_CONTRATO \
					SET    \
						CD_CUENTA_CHEQUES  = ?, \
						CD_MONEDA = ?,\
						CD_CONTRATO_SWIFT = ?,\
						NB_EMPRESA = ?,\
						PC_IVA = ?,\
						TP_CLIENTE_AAA = ?,\
						CD_CONTRATO_SICOCO = ?,\
						TP_ANUALIDAD = ?, \
						TP_MENSUALIDAD = ?, \
						TP_ARCH_SICOCO_GEN = ?\
					WHERE  CD_CUENTA_CHEQUES  = ?
##################################################

##Actualiza tabla de relacion cliente mx con moneda y aaa###
updateRelCteCuenta  = update TGM008_CUENTA set CD_CUENTA=? where CD_CLIENTE=?
##################################################

###Actualiza recaudo para un cliente #############	
updateRecaudo = 	update TGM001_CLIENTE \
					set \
						CD_REFERENCIA = ? ,\
						CD_PAIS = ? ,\
						CD_BIC_SW_CTE = ? ,\
						cd_cte_latam = ? ,\
						CD_BIC_EURO = ? ,\
						nb_cliente = ? ,\
						cd_acr_cliente = ? ,\
						cd_activo = ? ,\
						TM_MODIFICACION = sysdate \
					where CD_CLIENTE=?
##################################################

###Actualiza tabla de relacion cliente Servicio ##
updatRelClientSRV  = update TGM004_CTE_SERV set CD_OFI_SW_CTE=?, CD_TP_SRV_SWIFT=? where CD_CLIENTE=? and CD_TP_SERVICIO=?
################################################## 
					
###################################################
############ CUENTAS   RELAY  #####################
###################################################

##### Obtiene las cuentas relay #################

getRegisterRelay  = select \
				    	cte.CD_CLIENTE, 		\
				    	cte.CD_REFERENCIA,	\
				    	CTE.CD_PAIS ,			\
				    	(SELECT TX_PAIS FROM TGM006_PAIS P WHERE P.CD_PAIS=cte.CD_PAIS),\
				    	cte.CD_BIC_SW_CTE,		\
				    	cte.CD_OFI_SW_CTE_env,	\
				    	cte.CD_CTE_LATAM,		\
				    	cte.CD_BIC_EURO,	\
				    	cte.CD_BIC_SW_CTE_ENV,	\
				    	cte.NB_CLIENTE,			\
				    	cte.CD_ACR_CLIENTE,		\
				    	cte.TM_ALTA,			\
				    	cte.TM_BAJA,			\
				    	cte.TM_MODIFICACION,	\
				    	cte.CD_ACTIVO,			\
				    	cteserv.CD_TP_SERVICIO,\
				    	cteserv.CD_TP_SRV_SWIFT,\
				    	RELAY.CD_CTA_RELAY,		\
				    	RELAY.NB_BIC_RELAY,		\
				    	CUENTA.CD_CUENTA		\
				    from \
				    	TGM001_CLIENTE cte,		\
				    	TGM004_CTE_SERV cteserv,\
				    	TGM030_CTA_RELAY relay,\
				    	TGM008_CUENTA cuenta	\
				    where \
				    	cte.CD_CLIENTE = cteserv.CD_CLIENTE   AND \
				    	CTE.CD_CLIENTE = RELAY.CD_CLIENTE     AND \
				    	cte.CD_CLIENTE = cuenta.CD_CLIENTE    AND \
				    	cteserv.CD_TP_SERVICIO = 2 \
				    union \
				    select \
				    	cte.CD_CLIENTE, 		\
				    	cte.CD_REFERENCIA, 	\
				    	CTE.CD_PAIS,			\
				    	(SELECT TX_PAIS FROM TGM006_PAIS P WHERE P.CD_PAIS=cte.CD_PAIS),\
				    	cte.CD_BIC_SW_CTE,		\
				    	cte.CD_OFI_SW_CTE_env,	\
				    	cte.CD_CTE_LATAM,		\
				    	cte.CD_BIC_EURO,	\
				    	cte.CD_BIC_SW_CTE_ENV,	\
				    	cte.NB_CLIENTE,			\
				    	cte.CD_ACR_CLIENTE,		\
				    	cte.TM_ALTA,			\
				    	cte.TM_BAJA,			\
				    	cte.TM_MODIFICACION,	\
				    	cte.CD_ACTIVO,			\
				    	cteserv.CD_TP_SERVICIO,\
				    	cteserv.CD_TP_SRV_SWIFT,\
				    	RELAY.CD_CTA_RELAY,		\
				    	RELAY.NB_BIC_RELAY,		\
				    	(select CUENTA.CD_CUENTA from TGM008_CUENTA cuenta where CUENTA.CD_CLIENTE=CTESERV.CD_CLIENTE ) \
				    from \
				    	TGM001_CLIENTE cte,		\
				    	TGM004_CTE_SERV cteserv,\
				    	TGM030_CTA_RELAY relay \
				    where \
				    	cte.CD_CLIENTE = cteserv.CD_CLIENTE   AND \
				    	CTE.CD_CLIENTE = RELAY.CD_CLIENTE     and \
				    	CTESERV.CD_CLIENTE = RELAY.CD_CLIENTE and \
    					cteserv.CD_TP_SERVICIO = 2 order by 1 desc
##################################################

#################################################
#
#Inserta en la tabla de Relacion clientes mexico
saveRelCtaRelay   = 	insert into TGM030_CTA_RELAY \
						(CD_CLIENTE, CD_CTA_RELAY, nb_bic_relay, TM_ALTA) \
						values(?, ?, ?, sysdate)
##################################################

##Obtiene un cliente con consulta relay con cuenta asiganada##
getClientRelay = select * \
				 from \
				 	TGM001_CLIENTE cte, TGM004_CTE_SERV cteserv, \
				 	TGM005_CTE_CANAL  ctecnl, TGM008_CUENTA  cta, TGM030_CTA_RELAY relay \
				 where \
				    cte.CD_CLIENTE = cteserv.CD_CLIENTE AND \
				    cte.CD_CLIENTE = ctecnl.CD_CLIENTE AND \
				    cte.CD_CLIENTE = cta.CD_CLIENTE AND \
				    cte.CD_CLIENTE = relay.CD_CLIENTE AND \
				    cteserv.CD_TP_SERVICIO = ?  AND cte.CD_CLIENTE = ? AND RELAY.CD_CTA_RELAY = ?
##################################################

##Obtiene un cliente consulta relay de alta sin cuenta asiganada##
getClientSCRelay = 	select * \
                    from TGM001_CLIENTE cte, TGM004_CTE_SERV cteserv, \
                    TGM005_CTE_CANAL  ctecnl, TGM030_CTA_RELAY relay  \
                    where cte.CD_CLIENTE = cteserv.CD_CLIENTE AND \
                    cte.CD_CLIENTE = ctecnl.CD_CLIENTE AND \
                    cteserv.CD_CLIENTE = ctecnl.CD_CLIENTE AND \
                    cte.CD_CLIENTE = relay.CD_CLIENTE AND \
                    cteserv.CD_TP_SERVICIO = ?  AND cte.CD_CLIENTE = ? AND RELAY.CD_CTA_RELAY = ?
##################################################

##Obtiene un cliente MEXICO consultas relay de alta con cuenta asiganada##
getClientMXRelay  = select * \
                    from TGM001_CLIENTE cte, TGM004_CTE_SERV cteserv, \
                    TGM005_CTE_CANAL  ctecnl, TGM008_CUENTA  cta, \
                    TGM028_RL_CTE_MX ctemx , TGM030_CTA_RELAY relay \
                    where cte.CD_CLIENTE = cteserv.CD_CLIENTE AND \
                    cte.CD_CLIENTE = ctecnl.CD_CLIENTE AND  \
                    cte.CD_CLIENTE = cta.CD_CLIENTE AND \
                    cte.CD_CLIENTE = ctemx.CD_CLIENTE AND \
                    cte.CD_CLIENTE = relay.CD_CLIENTE AND \
                    cteserv.CD_CLIENTE = ctecnl.CD_CLIENTE AND \
                    cteserv.CD_CLIENTE = cta.CD_CLIENTE AND \
                    cteserv.CD_CLIENTE = ctemx.CD_CLIENTE AND \
                    cteserv.CD_CLIENTE = relay.CD_CLIENTE AND \
                    ctecnl.CD_CLIENTE = cta.CD_CLIENTE AND \
                    ctecnl.CD_CLIENTE = ctemx.CD_CLIENTE AND \
                    cta.CD_CLIENTE = ctemx.CD_CLIENTE AND \
                    cta.CD_CLIENTE = relay.CD_CLIENTE AND \
                    cteserv.CD_TP_SERVICIO = ? AND \
                    cte.CD_CLIENTE = ? AND \
                    relay.CD_CTA_RELAY = ?
##################################################

##Obtiene un cliente MEXICO consultas relay SIN cuenta asiganada##
getClientMXSCRelay  = select * \
                from TGM001_CLIENTE cte, TGM004_CTE_SERV cteserv, \
                     TGM005_CTE_CANAL  ctecnl,TGM028_RL_CTE_MX ctemx, \
                     TGM030_CTA_RELAY relay \
                where cte.CD_CLIENTE = cteserv.CD_CLIENTE AND \
                      cte.CD_CLIENTE = ctecnl.CD_CLIENTE AND  \
                      cte.CD_CLIENTE = ctemx.CD_CLIENTE AND \
                      cte.CD_CLIENTE = relay.CD_CLIENTE AND  \
                      cteserv.CD_CLIENTE = ctecnl.CD_CLIENTE AND \
                      cteserv.CD_CLIENTE = ctemx.CD_CLIENTE AND \
                      cteserv.CD_CLIENTE = relay.CD_CLIENTE AND \
                      ctecnl.CD_CLIENTE = ctemx.CD_CLIENTE AND \
                      ctecnl.CD_CLIENTE = relay.CD_CLIENTE AND \
                      cteserv.CD_TP_SERVICIO = ?  AND \
                      cte.CD_CLIENTE = ? AND \
                      RELAY.CD_CTA_RELAY = ?
##################################################

###Query para actualizar tabla de relacion cliente cuentas relay##
updateRelCtaRelay = update TGM030_CTA_RELAY cta set CTA.NB_BIC_RELAY =? , CTA.TM_MODIFICACION = sysdate where cta.CD_CLIENTE=? AND CTA.CD_CTA_RELAY =?
##################################################



###################################################
############     P A G O S    #####################
###################################################

####QUERY PARA OBTENER LOS PAGOS #################
getRegistersPays  = select \
						cte.CD_CLIENTE, 		\
						cte.CD_REFERENCIA,	\
						CTE.CD_PAIS ,			\
						(SELECT TX_PAIS FROM TGM006_PAIS P WHERE P.CD_PAIS=cte.CD_PAIS), cte.CD_BIC_SW_CTE,\
						cte.CD_OFI_SW_CTE_ENV,	\
						cte.CD_CTE_LATAM,		\
						cte.CD_BIC_EURO,	\
						cte.CD_BIC_SW_CTE_ENV,	\
						cte.NB_CLIENTE,			\
						cte.CD_ACR_CLIENTE,		\
						cte.TM_ALTA,			\
						cte.TM_BAJA,			\
						cte.TM_MODIFICACION,	\
						cte.CD_ACTIVO,			\
						cteserv.CD_TP_SERVICIO,\
						cteserv.CD_TP_SRV_SWIFT,\
						CUENTA.CD_CUENTA		\
					from \
						TGM001_CLIENTE cte,		\
						TGM004_CTE_SERV cteserv,\
						TGM008_CUENTA cuenta	\
					where \
						cte.CD_CLIENTE = cteserv.CD_CLIENTE 		AND \
						CTE.CD_CLIENTE = CUENTA.CD_CLIENTE  		AND \
						CTESERV.CD_CLIENTE = CUENTA.CD_CLIENTE 	AND \
						cteserv.CD_TP_SERVICIO = 3 \
					union \
					select \
						cte.CD_CLIENTE,		\
						cte.CD_REFERENCIA,	\
						CTE.CD_PAIS ,			\
						(SELECT TX_PAIS FROM TGM006_PAIS P WHERE P.CD_PAIS=cte.CD_PAIS), \
						cte.CD_BIC_SW_CTE, 		\
						cte.CD_OFI_SW_CTE_env,	\
						cte.CD_CTE_LATAM,		\
						cte.CD_BIC_EURO,	\
						cte.CD_BIC_SW_CTE_ENV,	\
						cte.NB_CLIENTE,			\
						cte.CD_ACR_CLIENTE,		\
						cte.TM_ALTA,			\
						cte.TM_BAJA,			\
						cte.TM_MODIFICACION,	\
						cte.CD_ACTIVO,			\
						cteserv.CD_TP_SERVICIO,\
						cteserv.CD_TP_SRV_SWIFT,\
						(select CUENTA.CD_CUENTA from TGM008_CUENTA cuenta where CUENTA.CD_CLIENTE=CTESERV.CD_CLIENTE ) \
					from \
						TGM001_CLIENTE cte,		\
						TGM004_CTE_SERV cteserv \
					where \
						cte.CD_CLIENTE = cteserv.CD_CLIENTE AND \
						cteserv.CD_TP_SERVICIO = 3 order by 1 desc
##################################################

### Obtiene la lista de productos contratados ####
getPrdCont = select * from TGM013_PROD_CONTRA where cd_activo=1 AND CD_PAIS=?
##################################################

###Inserta en la tabla de Relacion clientes mexico#
saveRelClientPc = 	insert into TGM014_CTE_PRODCON \
						(CD_CLIENTE, CD_PRD_CONTRATADO) \
						values(?, ?)
##################################################

###Actualiza en la tabla de Relacion clientes/canal#
updateRLCteCnl = update TGM005_CTE_CANAL set CD_TP_CANAL=? where CD_CLIENTE=?
##################################################

####Inserta un nuevo  pago para un cliente #######
saveRegisterPay  = 	insert into TGM001_CLIENTE \
					(CD_REFERENCIA, CD_PAIS, CD_BIC_SW_CTE, CD_BIC_SW_CTE_ENV, CD_OFI_SW_CTE_env , cd_cte_latam, CD_BIC_EURO, nb_cliente, cd_acr_cliente, TM_ALTA, cd_activo) \
					values(?,?,?,?,?,?,?,?,?,sysdate,?)
##################################################

###Actualiza en la tabla Bic Envio de un cliente #
updateBICSend = update TGM001_CLIENTE set CD_BIC_SW_CTE_ENV=?, CD_OFI_SW_CTE_env=? where CD_CLIENTE=?
##################################################

###Actualiza tabla de relacion cliente canal######
updatRelClientCnl  = update TGM005_CTE_CANAL set CD_TP_CANAL=? where CD_CLIENTE=?
##################################################

#################################################
#
#Actualiza pago para un cliente
updatePay = 	update TGM001_CLIENTE \
					set \
						CD_REFERENCIA = ? ,\
						CD_PAIS = ? ,\
						CD_BIC_SW_CTE = ? ,\
						cd_cte_latam = ? ,\
						CD_BIC_EURO = ? ,\
						nb_cliente = ? ,\
						cd_acr_cliente = ? ,\
						cd_activo = ? ,\
						TM_MODIFICACION = sysdate, \
						CD_BIC_SW_CTE_ENV = ?, \
						CD_OFI_SW_CTE_env = ? \
					where CD_CLIENTE=?
##################################################

###Obtiene los productos contratados por cliente##
getProductsC  = 	select * from TGM014_CTE_PRODCON where CD_CLIENTE=?
##################################################



####################################################
####################################################
############M O N I T O R E O#######################
####################################################

monitorRecRey = SELECT T009.*, T010.*, T011.nb_masc_archivo, T011.CD_TP_SRV_SWIFT, T011.CD_PAIS, T011.CD_TP_SERVICIO, \
                T006.TX_PAIS, T007.NB_TP_SRV_SWIFT, T002.NB_TP_SERVICIO, NVL(T000.BIC, ' ') BIC_ORIGEN \
                FROM TGM009_ARCHPRC_LOG T009 \
                INNER JOIN TGM010_ST_ARCHIVO T010 ON T009.CD_ST_ARCHIVO = T010.CD_ST_ARCHIVO \
                INNER JOIN TGM011_ARCH_PRC T011 ON T009.CD_TP_ARCHIVO = T011.CD_TP_ARCHIVO \
                INNER JOIN TGM002_SERVICIO T002 ON T011.CD_TP_SERVICIO = T002.CD_TP_SERVICIO \
                INNER JOIN TGM006_PAIS T006 ON T011.CD_PAIS = T006.CD_PAIS \
                INNER JOIN TGM007_SRV_SWIFT T007 ON T011.CD_TP_SRV_SWIFT = T007.CD_TP_SRV_SWIFT \
                LEFT JOIN (SELECT DISTINCT SUBSTR(A009.NB_ARCH_PROCESADO, 5, 8) BIC, SUBSTR(A009.NB_ARCH_PROCESADO, 17, 8) REFE, \
                  SUBSTR(A009.NB_ARCH_PROCESADO, 26, 7) FOLIO \
                  FROM TGM009_ARCHPRC_LOG A009 \
                  INNER JOIN TGM011_ARCH_PRC A011 ON A009.CD_TP_ARCHIVO = A011.CD_TP_ARCHIVO \
                  INNER JOIN TGM002_SERVICIO A002 ON A011.CD_TP_SERVICIO = A002.CD_TP_SERVICIO \
                  WHERE A002.CD_TP_SERVICIO = ? \
                  AND \
                  TM_PROCESO between to_date(?,'dd-mm-YYYY') and to_date(?,'dd-mm-YYYY')+1 \
                  AND A009.tp_ent_sal_bbva = ?) T000 \
                  ON SUBSTR(T009.NB_ARCH_PROCESADO, 6, 8) = T000.REFE AND SUBSTR(T009.NB_ARCH_PROCESADO, 35, 7) = T000.FOLIO \
                WHERE T002.CD_TP_SERVICIO = ? AND \
                TM_PROCESO between to_date(?,'dd-mm-YYYY') and to_date(?,'dd-mm-YYYY')+1  \
                AND T009.tp_ent_sal_bbva = ? \
                order by TM_PROCESO             		

getRegisterBtArch = select   btarch.*, starch.*,ctarch.nb_masc_archivo, ctarch.CD_TP_SRV_SWIFT, ctarch.CD_PAIS, ctarch.CD_TP_SERVICIO, \
						(select pais.TX_PAIS from TGM006_PAIS pais where ctarch.CD_PAIS=pais.CD_PAIS) TX_PAIS, \
	                    (select srvswift.NB_TP_SRV_SWIFT from TGM007_SRV_SWIFT srvswift where ctarch.CD_TP_SRV_SWIFT=srvswift.CD_TP_SRV_SWIFT) NB_TP_SRV_SWIFT, \
	                    (select srv.NB_TP_SERVICIO from TGM002_SERVICIO srv where srv.CD_TP_SERVICIO= ctarch.CD_TP_SERVICIO) NB_TP_SERVICIO \
                	from \
                    	TGM009_ARCHPRC_LOG btarch, \
                    	TGM010_ST_ARCHIVO starch, \
                    	TGM011_ARCH_PRC ctarch, \
                    	TGM002_SERVICIO srv \
                	where \
                     btarch.CD_ST_ARCHIVO=starch.CD_ST_ARCHIVO and \
                     btarch.CD_TP_ARCHIVO=ctarch.CD_TP_ARCHIVO and \
                     ctarch.CD_TP_SERVICIO=srv.CD_TP_SERVICIO and \
                     srv.CD_TP_SERVICIO= ? \
                     and btarch.CD_ARCH_PROCESADO = ?
                     

monitoreoRecPago = SELECT A.*, B.NB_ST_ARCHIVO FROM TGM009_ARCHPRC_LOG A, \
					TGM010_ST_ARCHIVO B \
					WHERE CD_TP_ARCHIVO = 3         \
					AND TM_PROCESO between to_date(?,'dd-mm-YYYY') and to_date(?,'dd-mm-YYYY')+1 \
					AND A.CD_ST_ARCHIVO = B.CD_ST_ARCHIVO  \
					AND  ( NB_ARCH_PROCESADO LIKE 'JANJ%' OR NB_ARCH_PROCESADO LIKE 'RECE%') 


monitoreoRepPago = SELECT A.*, B.NB_ST_ARCHIVO FROM TGM009_ARCHPRC_LOG A, \
					TGM010_ST_ARCHIVO B WHERE NB_ARCH_PROCESADO LIKE ? AND CD_TP_ARCHIVO = ? AND A.CD_ST_ARCHIVO = B.CD_ST_ARCHIVO 
                     
                     
                     
 ############################################################
 ############ D O C U M E N T A C I O N #####################
 ############################################################
 
 getDocument1 = select * from TGM021_DOCUMENTO where CD_LIGA = ?
 
 getAllDocuments1 = select * from TGM001_CT_DOCWEB
 
 
 getDocumentByName = select DOC.CD_DOCUMENTO, DOC.CD_LIGA, DOC.nb_documento, DOC.nu_orden from TGM021_DOCUMENTO DOC where DOC.nb_documento = ? 
 
 getDocument = select DOC.NB_DOCUMENTO, DOC.TX_DOCUMENTO from TGM021_DOCUMENTO DOC where CD_DOCUMENTO = ?
 
 getAllDocuments = select DOC.CD_DOCUMENTO, DOC.CD_LIGA, DOC.NB_DOCUMENTO, DOC.NU_ORDEN, LIGA.NB_RUTA_LIGA \
					from TGM020_LIGA LIGA, TGM021_DOCUMENTO DOC \
					where DOC.CD_LIGA = LIGA.CD_LIGA \
					order by DOC.CD_DOCUMENTO desc  
  
 ####Inserta un archivo de cualquier tipo en la tabla CT_DOCWEB como arreglo de bytes #######
					
 saveDocument  = 	insert into TGM021_DOCUMENTO \
					(CD_LIGA, NB_DOCUMENTO, TX_DOCUMENTO, NU_ORDEN) \
					values(?,?,empty_Blob(),?)					
					
 updateDocument =	select DOC.TX_DOCUMENTO from TGM021_DOCUMENTO DOC where CD_DOCUMENTO = ? for update
 
 saveLink = insert into TGM020_LIGA \
 			(CD_SECCION, CD_SUBSECCION, CD_TP_LIGA, NB_LIGA, NB_RUTA_LIGA, NU_ORDEN, TP_LIGA_PRIVADA, TX_LIGA) \
 			values (?,?,?,?,?,?,?,?)
 			
 getAllFromLink = select LIGA.CD_LIGA from TGM020_LIGA LIGA where LIGA.CD_SECCION=? and LIGA.CD_SUBSECCION=? and LIGA.CD_TP_LIGA=2 and LIGA.NB_RUTA_LIGA IS NULL
 
 deleteDocument = delete from TGM021_DOCUMENTO DOC where DOC.CD_DOCUMENTO = ? 
  								
##################################################
 ####Obtiene el ComboBox del pais Mostrado en el Monitor
obtenerComboSwift = SELECT CD_PAIS,TX_PAIS,NB_PAIS \
      				FROM TGM006_PAIS WHERE CD_PAIS IN ( \
      				SELECT DISTINCT (B.CD_PAIS) \
      				FROM  ( \
	  				SELECT CD_LIGA \
      				FROM TGM022_LIGA_GRUPO where CD_GRUPO IN ( \
      				SELECT CD_GRUPO FROM TGM025_USUARIO_GRU where CD_USUARIO = ?) ) A1 \
      				INNER JOIN( \
	  				SELECT CD_LIGA,CD_PAIS FROM TGM020_LIGA )B ON A1.CD_LIGA = B.CD_LIGA) \
					UNION \
      				SELECT CD_PAIS,TX_PAIS,NB_PAIS \
      				FROM TGM006_PAIS WHERE CD_PAIS IN ( \
      				SELECT CD_PAIS \
      				FROM TGM020_LIGA \
      				WHERE TP_LIGA_PRIVADA = 0) \
					UNION \
	  				SELECT CD_PAIS,TX_PAIS,NB_PAIS \
	  				FROM TGM006_PAIS WHERE CD_PAIS IN ( \
	  				SELECT DISTINCT (BB.CD_PAIS) \
      				FROM ( \
	  				SELECT CD_LIGA \
      				FROM TGM024_LIGA_USUARI WHERE CD_USUARIO = ?)AA \
      				INNER JOIN ( \
	  				SELECT CD_PAIS,CD_LIGA FROM TGM020_LIGA )BB ON BB.CD_LIGA = AA.CD_LIGA)
	  
	  
################################################
 
 
############################################################
############ CREAARCION DEL MENU ###########################
############################################################

getAllMenus = select CD_SECCION, nb_seccion from TGM017_SECCION order by nu_orden

getSubMenu = select CD_SUBSECCION, nb_subseccion from TGM018_SUBSECCION where CD_SECCION=? order by nu_orden

##############Menu acceso general###########################

getSubMenuLinkPublic   = select * from TGM020_LIGA where CD_SECCION=?  and CD_SUBSECCion is null and tp_liga_privada=0 order by nu_orden

getLinksPublic  = select * from TGM020_LIGA where CD_SECCION=? and CD_SUBSECCION=? and tp_liga_privada = 0 order by nu_orden

############################################################

##############Menu acceso by group & User###################

getLinksPublics = select liga.cd_liga from TGM020_LIGA liga where liga.TP_LIGA_PRIVADA = ?

getLinksByGroup = select * from TGM022_LIGA_GRUPO where CD_GRUPO = ?

getLinksByIdUser = select CD_LIGA from TGM024_LIGA_USUARI where CD_USUARIO = ? group by CD_LIGA

############################################################
getSubMenuLinkPrivate  = select * from TGM020_LIGA where CD_SECCION=? and CD_SUBSECCION is null AND CD_PAIS is null \
							union \
						select * from TGM020_LIGA where CD_SECCION=? and CD_SUBSECCION is null AND CD_PAIS=? \
						ORDER BY 8

getSubMenuLinkPrivateByCountry  = select * from TGM020_LIGA where CD_SECCION=? and CD_SUBSECCION is null and CD_PAIS = ? \
									union \
								  select * from TGM020_LIGA where CD_SECCION=? and CD_SUBSECCION is null and CD_PAIS is null order by 7
								  
getSubMenuLinkPublic   = select * from TGM020_LIGA where CD_SECCION=?  and CD_SUBSECCion is null and tp_liga_privada=0 order by nu_orden



getLinksPrivate = select * from TGM020_LIGA where CD_SECCION=? and CD_SUBSECCION=? order by nu_orden

getLinksPrivateByCountry = select * from TGM020_LIGA where CD_SECCION=? and CD_SUBSECCION=? and CD_PAIS =  ? \
							union \
						   select * from TGM020_LIGA where CD_SECCION=? and CD_SUBSECCION=? and CD_PAIS is null order by 7

getLinkSubSeccionNull = select liga.* from \
                                            TGM020_LIGA liga, \
                                            TGM017_SECCION sec \
                        where \
                               liga.CD_SECCION = sec.CD_SECCION and \
                               sec.CD_SECCION = ? and \
                			   liga.nb_liga = ? and \
                			   liga.CD_LIGA = ? and \
                               cd_pais is null \
union \
select liga.* from \
                                            TGM020_LIGA liga, \
                                            TGM017_SECCION sec \
                        where \
                               liga.CD_SECCION = sec.CD_SECCION and \
                               sec.CD_SECCION = ? and \
                			   liga.nb_liga = ? and \
                			   liga.CD_LIGA = ? and \
                               cd_pais =?

getLink = select * from TGM020_LIGA where CD_LIGA = ? and CD_SECCION = ? and CD_SUBSECCION = ? and cd_pais is null \
			union \
			select * from TGM020_LIGA where CD_LIGA = ? and CD_SECCION = ? and CD_SUBSECCION = ? and cd_pais = ?






#############################################################
########### MONITOR MACUG QUERYES ###########################
#############################################################

getSwiftDetails = SELECT * FROM TGM053_LOTE_ENT WHERE NU_ARCH_PROCESADO = ?

getGeneratedFiles = select * from TGM052_BT_ARCH_GEN where nu_arch_generado = ?

getMasterBlog = select   btarch.*, starch.*,ctarch.nb_masc_archivo, ctarch.CD_TP_SRV_SWIFT, ctarch.CD_PAIS, ctarch.CD_TP_SERVICIO, \
						(select pais.TX_PAIS from TGM006_PAIS pais where ctarch.CD_PAIS=pais.CD_PAIS), \
	                    (select srvswift.NB_TP_SRV_SWIFT from TGM007_SRV_SWIFT srvswift where ctarch.CD_TP_SRV_SWIFT=srvswift.CD_TP_SRV_SWIFT), \
	                    (select srv.NB_TP_SERVICIO from TGM002_SERVICIO srv where srv.CD_TP_SERVICIO= ctarch.CD_TP_SERVICIO), \
                        flujo.TP_ENT_SAL_BBVA, flujo.NB_FLUJO_BBVA \
                	from \
                    	TGM009_ARCHPRC_LOG btarch, \
                    	TGM010_ST_ARCHIVO starch, \
                    	TGM011_ARCH_PRC ctarch, \
                    	TGM002_SERVICIO srv,\
                        TGM059_FLUJO_BBVA flujo \
                	where \
                     btarch.CD_ST_ARCHIVO=starch.CD_ST_ARCHIVO and \
                     btarch.CD_TP_ARCHIVO=ctarch.CD_TP_ARCHIVO and \
                     ctarch.CD_TP_SERVICIO=srv.CD_TP_SERVICIO and \
                     flujo.TP_ENT_SAL_BBVA = btarch.TP_ENT_SAL_BBVA and

getAllFlows = select * from TGM059_FLUJO_BBVA order by 1


################################################################################
################  PARAMETRIZACIN MACUG ########################################
################################################################################
getParameters = select param.NU_PARAMETRO, param.CD_PAIS, pais.TX_PAIS, param.CD_TP_CANAL, canal.NB_CANAL, info.TX_DESTINO_ENT, info.TP_ESPERA_ACUSE \
      			from tGM060_param_ctesw param, tGM058_info_pc_cs info, TGM003_CANAL canal, TGM006_PAIS pais \
    			where \
            			param.CD_PAIS = info.CD_PAIS and \
            			param.CD_PAIS = pais.CD_PAIS and \
            			param.CD_TP_CANAL = canal.CD_TP_CANAL

################################################################################
################  Obtener parametro unuico #####################################
################################################################################

getParam = select * from tGM060_param_ctesw where nu_parametro = ?

getParamsList = select * from tGM060_param_ctesw


################################################################################
################  update parameter #############################################
################################################################################

updateParameterUno = update tGM058_info_pc_cs set tp_espera_acuse =?  where CD_PAIS = ? and CD_TP_CANAL = ?

updateParameterCero = update tGM058_info_pc_cs set tp_espera_acuse =0  where CD_PAIS = ? and CD_TP_CANAL = ?

updateAll = update tGM058_info_pc_cs set tp_espera_acuse =0

################################################################################
################################################################################
################################################################################

monitorRecRey2 = select   btarch.*, starch.*, ctarch.nb_masc_archivo, ctarch.CD_TP_SRV_SWIFT, ctarch.CD_PAIS, ctarch.CD_TP_SERVICIO, \
					(select pais.TX_PAIS from TGM006_PAIS pais where ctarch.CD_PAIS=pais.CD_PAIS), \
					(select srvswift.NB_TP_SRV_SWIFT from TGM007_SRV_SWIFT srvswift where ctarch.CD_TP_SRV_SWIFT=srvswift.CD_TP_SRV_SWIFT), \
         			(select srv.NB_TP_SERVICIO from TGM002_SERVICIO srv where srv.CD_TP_SERVICIO= ctarch.CD_TP_SERVICIO),canal.NB_CANAL \
				from \
					TGM009_ARCHPRC_LOG btarch, \
					TGM010_ST_ARCHIVO starch, \
					TGM011_ARCH_PRC ctarch, \
					TGM002_SERVICIO srv, \
					TGM003_CANAL canal \
				where \
             		btarch.CD_ST_ARCHIVO=starch.CD_ST_ARCHIVO and \
             		btarch.CD_TP_ARCHIVO=ctarch.CD_TP_ARCHIVO and \
             		ctarch.CD_TP_SERVICIO=srv.CD_TP_SERVICIO and \
             		canal.CD_TP_CANAL = srv.CD_TP_CANAL and \
             		srv.CD_TP_SERVICIO=? \
             		and to_char(btarch.fh_proceso,'dd-mm-YYYY') = ?
             		
monitorMacugIn = SELECT BTARCH.*, PAIS.CD_PAIS, PAIS.TX_PAIS \
				 FROM \
				 	   TGM009_ARCHPRC_LOG BTARCH, \
				 	   TGM006_PAIS PAIS \
			   	 WHERE \
			   	 		CD_TP_ARCHIVO IS NULL AND \
			   	 		BTARCH.CD_PAIS = PAIS.CD_PAIS
			   	 		
##############################################################################
#####################administraciones#########################################
##############################################################################
##############################################################################

 ##### SECCIONES, LIGAS, PERMISOS #####
 
 getAllSecciones = select * from TGM017_SECCION SECC order by SECC.CD_SECCION
 
 getAllLigas = select * from TGM019_TP_LIGA TLIGA order by TLIGA.CD_TP_LIGA
 
 getSubseccById = select * from TGM018_SUBSECCION SUBS where SUBS.CD_SECCION = ?
 
 getLinkNosubsecc = select * from TGM020_LIGA LIGA where LIGA.CD_SECCION = ? and LIGA.CD_SUBSECCION IS NULL
 
 getBlobNosubsecc = select * from TGM020_LIGA LIGA where LIGA.CD_SECCION = ? and LIGA.CD_TP_LIGA = 2 and LIGA.CD_SUBSECCION IS NULL
 
 getLinkSubsecc = select * from  TGM020_LIGA LIGA where LIGA.CD_SECCION = ? and LIGA.CD_SUBSECCION = ?
 
 getBlobSubsecc = select * from  TGM020_LIGA LIGA where LIGA.CD_SECCION = ? and LIGA.CD_TP_LIGA = 2 and LIGA.CD_SUBSECCION = ?
 
 insertLink = insert into TGM020_LIGA LI \
 				(LI.CD_SECCION, LI.CD_SUBSECCION, LI.CD_TP_LIGA, LI.NB_LIGA, LI.NB_RUTA_LIGA, LI.NU_ORDEN, LI.TP_LIGA_PRIVADA, LI.TX_LIGA) \
 				values(?,?,?,?,?,?,?,?)
 							
 deleteLink = delete from TGM020_LIGA LIGA where LIGA.CD_LIGA = ? 
 
 updateLink = update TGM020_LIGA LIGA \
				    set LIGA.CD_TP_LIGA = ?, \
				        LIGA.NB_LIGA = ?, \
				        LIGA.NB_RUTA_LIGA = ?, \
				        LIGA.NU_ORDEN = ?, \
				        LIGA.TP_LIGA_PRIVADA = ?, \
				        LIGA.TX_LIGA = ? \
				where LIGA.CD_LIGA = ?
				
 updateOrderLink = 	update TGM020_LIGA LIGA \
						set LIGA.NU_ORDEN = ? \
					where LIGA.CD_LIGA = ?

 updateOrderSeccion = update TGM017_SECCION SECC \
	 				 set SECC.NU_ORDEN = ? \
 				 	where SECC.CD_SECCION = ?
					
 updateOrderSubsec = update TGM018_SUBSECCION SUBSECC \
 						set SUBSECC.NU_ORDEN = ? \
 					where SUBSECC.CD_SUBSECCION = ?
 					
 asignarGrupo = insert into TGM022_LIGA_GRUPO LG \
 				(LG.CD_LIGA, LG.CD_GRUPO) \
 				values (?,?)				
				
 getAllPaises = select * from TGM006_PAIS order by TX_PAIS
 
 getAllGrupos = select * from TGM016_GRUPO_USR order by NB_GRUPO
 
 getUsuarioporId = select * from TGM023_USUARIO USR \
 				   where USR.CD_PAIS = ? order by NB_NOMBRE_USR
 
 getLigaporSeccion = (select LI.CD_LIGA, LI.CD_SUBSECCION, LI.TX_LIGA, SUB.NB_SUBSECCION from TGM020_LIGA LI, TGM018_SUBSECCION SUB \
        			  	where LI.CD_SECCION = ? \
        			  	AND LI.CD_SUBSECCION = SUB.CD_SUBSECCION) \
					 UNION \
					 (select LI.CD_LIGA, LI.CD_SUBSECCION, LI.TX_LIGA, NULL  from TGM020_LIGA LI \
					  	where LI.CD_SECCION = ? \
					  	AND LI.CD_SUBSECCION IS NULL)
 					  	
 getPermisosLgasxUsr = select * from TGM024_LIGA_USUARI LIUSR \
					where LIUSR.CD_USUARIO = ?
					
 getPermisosLgasxGpo = select * from TGM022_LIGA_GRUPO LIGPO \
 					where LIGPO.CD_GRUPO = ?
 					
 					
 getLigaUser = select * from TGM024_LIGA_USUARI \
			   where CD_LIGA = ? \
			   and CD_USUARIO = ?
			   
 getLigaGrupo = select * from TGM022_LIGA_GRUPO \
			   where CD_LIGA = ? \
			   and CD_GRUPO = ?
			   
 insertLigaUser = insert into TGM024_LIGA_USUARI \
			   		  (CD_LIGA, CD_USUARIO) \
			   		  values (?,?)
			   		  
 insertUserGrupo = insert into TGM025_USUARIO_GRU \
 					(CD_USUARIO,CD_GRUPO) \
 					values (?,?)
 			   		  
			   		  
 insertLigaGrupo = insert into TGM022_LIGA_GRUPO \
 					(CD_LIGA, CD_GRUPO) \
 					values (?,?)
 			   		  
			   		  
 deleteLigaUser = delete from TGM024_LIGA_USUARI \
 				  where CD_LIGA = ? \
			   	  and CD_USUARIO = ? 			   		  
			   
 deleteLigaGrupo = delete from TGM022_LIGA_GRUPO \
 				   where CD_LIGA = ? \
 				   and CD_GRUPO = ?
 				   
 				   
 				   
 				   
 				   
 insertSeccion = insert into TGM017_SECCION SECC \
 				 (SECC.NB_SECCION, SECC.NU_ORDEN) \
 				 values (?,?)
 				 
 updateSeccion = update TGM017_SECCION SECC \
	 				 set SECC.NB_SECCION = ?, \
	 				 SECC.NU_ORDEN = ? \
 				 where SECC.CD_SECCION = ?
 				 
 deleteSeccion = delete from TGM017_SECCION SECC where SECC.CD_SECCION = ?
 
 
 
 
 insertSubseccion = insert into TGM018_SUBSECCION SUBSECC \
 					(SUBSECC.CD_SECCION, SUBSECC.NB_SUBSECCION, SUBSECC.NU_ORDEN) \
 					values (?,?,?)
 					
 updateSubseccion = update TGM018_SUBSECCION SUBSECC \
 						set SUBSECC.NB_SUBSECCION = ?, \
 						SUBSECC.NU_ORDEN = ? \
 					where SUBSECC.CD_SUBSECCION = ?
 					
 deleteSubseccion = delete from TGM018_SUBSECCION SUBSECC where SUBSECC.CD_SUBSECCION = ?
 
 				 
 getLigasBlobs = select * from TGM020_LIGA LIGA where LIGA.CD_TP_LIGA = 2
 
 getDoctosXliga = select * from TGM021_DOCUMENTO DCTO where DCTO.CD_LIGA = ?
 
 getDoctosXTipo = select * from TGM020_LIGA LIGA where LIGA.CD_TP_LIGA = 4 AND LIGA.NB_LIGA = ?  order by NU_ORDEN
 
 getLigaXid = select * from TGM020_LIGA LIGA where LIGA.CD_LIGA = ?
 
 getInterfaces = select INTER.CD_INTERFAZ, PAIS.TX_PAIS, INTER.NB_INTERFAZ, INTER.TP_INTERFAZ, INTER.NB_HORARIO, \
 				INTER.NB_EQU_CONTRAPARTE, INTER.nb_SIST_CONTRAPARTE, INTER.TX_INTERFAZ_1, INTER.TX_INTERFAZ_2, PAIS.CD_PAIS, \
				INTER.NB_AREA_NEGOCIO, INTER.NB_SERVICIO, INTER.NB_RESP_USUARIO, INTER.NB_RESP_APLICACION \
				from TGM067_INTERFAZ INTER, TGM006_PAIS PAIS \
				where INTER.CD_PAIS = PAIS.CD_PAIS \
				order by INTER.CD_INTERFAZ desc
 
 getInterfacesSearch = select * from TGM067_INTERFAZ where NB_INTERFAZ = ?
 
 
##############################################################################
#####################SECCION GENERAL#########################################
##############################################################################
##############################################################################
				 
    					

##############################################################################
#####################security queries#########################################
##############################################################################
##############################################################################

updatePass = update TGM023_USUARIO set CD_CONTRASENIA=?, TM_ULTIMO_ACCESO=sysdate, TM_CAMBIO_CNTRASEN=sysdate where cd_clave_usuario=?

updateLoginAcces = update TGM023_USUARIO set TM_ULTIMO_ACCESO=sysdate where CD_CLAVE_USUARIO=?

updateCambioPass = update TGM023_USUARIO set CD_CONTRASENIA=?, TM_CAMBIO_CNTRASEN=sysdate where CD_CLAVE_USUARIO=?

getLimitConnections = select usr.CT_CONEX_LIMITE from TGM023_USUARIO usr where cd_clave_usuario = ?

getActiveConnections = select usr.CT_CONEX_ACTIVAS from TGM023_USUARIO usr where cd_clave_usuario = ?

updateActiveConnections = update TGM023_USUARIO set CT_CONEX_ACTIVAS=(select usr.CT_CONEX_ACTIVAS+1 from TGM023_USUARIO usr where cd_clave_usuario = ?), TM_ULTIMO_ACCESO=sysdate where cd_clave_usuario=?

updateLoginTry = update TGM023_USUARIO set CT_LOGEO_ERRONEO = (select usr.CT_LOGEO_ERRONEO+1 from TGM023_USUARIO usr where cd_clave_usuario = ?) where cd_clave_usuario=?

getGroupsByIdUser =  select CD_GRUPO from TGM025_USUARIO_GRU where CD_USUARIO = ?

countGroupsByIdUser =  select count(CD_GRUPO) from TGM025_USUARIO_GRU where CD_USUARIO = ?

resetLogAcount =   update TGM023_USUARIO set CT_LOGEO_ERRONEO = 0 where cd_clave_usuario=?

getGroupsByUser = select usr.CD_GRUPO, b.NB_GRUPO from TGM025_USUARIO_GRU usr, TGM016_GRUPO_USR b  WHERE usr.CD_GRUPO = b.CD_GRUPO and usr.CD_USUARIO = ?

#################
getUsers = select *  from TGM023_USUARIO usuario, TGM006_PAIS pais where usuario.CD_PAIS=pais.CD_PAIS order by nb_nombre_usr


getGroupsByUser = select usr.CD_GRUPO, b.NB_GRUPO from TGM025_USUARIO_GRU usr, TGM016_GRUPO_USR b  WHERE usr.CD_GRUPO = b.CD_GRUPO and usr.CD_USUARIO = ?


########DIRECTORIO##############

getDirectory = SELECT * FROM TGM065_DIRECTORIO ORDER BY NB_PAIS

getDirectory1 = SELECT CD_DIRECTORIO, NB_AREA, NB_USUARIO, B.NB_PAIS, NB_TELEFONO, NB_CORREO_ELECT, NB_BANCO, NB_EXTENSION, TP_IDENTIFICADOR FROM TGM065_DIRECTORIO A, TGM006_PAIS B WHERE A.NB_PAIS = B.TX_PAIS AND TP_IDENTIFICADOR = 3 ORDER BY B.NB_PAIS 

getDirectory2 = SELECT * FROM TGM065_DIRECTORIO WHERE TP_IDENTIFICADOR = 1 ORDER BY NB_PAIS 

getDirectory3 = SELECT CD_DIRECTORIO, NB_AREA, NB_USUARIO, B.NB_PAIS, NB_TELEFONO, NB_CORREO_ELECT, NB_BANCO, NB_EXTENSION, TP_IDENTIFICADOR FROM TGM065_DIRECTORIO A, TGM006_PAIS B WHERE A.NB_PAIS = B.TX_PAIS AND TP_IDENTIFICADOR = 2 ORDER BY B.NB_PAIS 

getDirectorySearch = SELECT * FROM TGM065_DIRECTORIO WHERE NB_USUARIO = ?

getPaisesDir = SELECT NB_PAIS, TX_PAIS FROM TGM006_PAIS ORDER BY NB_PAIS



########## Obtine las Utilerias de tabla ##############
getConfigUtilerias = SELECT CD_PARAMETRO, NB_PARAM_CFG FROM TGM046_PARAM_CFG WHERE CD_PARAMETRO_PADRE = 1 AND NB_PARAM_CFG IS NOT NULL ORDER BY NB_PARAM_CFG 

getConfigInstancias = SELECT CD_PARAMETRO, NB_PARAM_CFG FROM TGM046_PARAM_CFG WHERE CD_PARAMETRO_PADRE = ? ORDER BY NB_PARAM_CFG 
							 
getReporteUtilerias = SELECT NB_PARAM_CFG, TX_VALOR, CD_PARAMETRO, CD_PARAMETRO_PADRE from TGM046_PARAM_CFG CONNECT BY PRIOR CD_PARAMETRO = CD_PARAMETRO_PADRE START WITH CD_PARAMETRO_PADRE = ?

getSearchUtilerias = SELECT COUNT(*) FROM TGM046_PARAM_CFG WHERE CD_PARAMETRO_PADRE = ? AND NB_PARAM_CFG = ? AND TX_VALOR = ?

getSearchInstancias = SELECT COUNT(*) FROM TGM046_PARAM_CFG WHERE NB_PARAM_CFG = ? AND CD_PARAMETRO_PADRE = ? 

getNombreInstancia = SELECT NB_PARAM_CFG FROM TGM046_PARAM_CFG WHERE CD_PARAMETRO = ?

getGISList = SELECT CD_PROCESO_GIS, NB_PROCESO_GIS FROM TGM033_PROCESO_GIS ORDER BY NB_PROCESO_GIS

getProcesoGIS = SELECT NVL(cd_proceso_gis,0) cd_proceso_gis FROM TGM046_PARAM_CFG WHERE cd_parametro = ?


##########################  Proceso de Transformacin ########################33

getPaisesTrans = SELECT CD_PAIS, UPPER(TX_PAIS) TX_PAIS FROM TGM006_PAIS ORDER BY NB_PAIS

getProcesosMap = SELECT CD_PROCSI_GEN, NB_PROCSI_GEN FROM TGM104_PROCSI_GEN ORDER BY NB_PROCSI_GEN

getParamDatos = SELECT TGM105.NB_PARAM, TGM105.TX_PARAM, TGM105.CD_HABILITADO, TGM105.CD_PROCSI_GEN, NVL(TGM104.CD_PROCSI_RES,-1) CD_PROCSI_RES, TGM104.NB_PROCSI_GEN \
				FROM TGM105_PROCSI_SCR TGM105, TGM104_PROCSI_GEN TGM104 \
				WHERE TGM105.CD_PROCSI_GEN = ?   \
				AND TGM105.CD_PROCSI_GEN = TGM104.CD_PROCSI_GEN ORDER BY TGM105.NU_ORDEN

getParamDatosRespuesta = SELECT TGM105.NB_PARAM, TGM105.TX_PARAM, TGM105.CD_HABILITADO, TGM105.CD_PROCSI_GEN, NVL(TGM104.CD_PROCSI_RES,-1) CD_PROCSI_RES, TGM104.NB_PROCSI_GEN \
				FROM TGM105_PROCSI_SCR TGM105, TGM104_PROCSI_GEN TGM104 \
				WHERE TGM105.CD_PROCSI_GEN = (SELECT CD_PROCSI_RES FROM TGM104_PROCSI_GEN WHERE CD_PROCSI_GEN = ?) AND TGM105.CD_PROCSI_GEN = TGM104.CD_PROCSI_GEN ORDER BY TGM105.NU_ORDEN 
				
				

getParamDatos46 = SELECT A.NB_PARAM, B.TX_VALOR, A.CD_HABILITADO, A.CD_PROCSI_GEN, A.CD_PROCSI_RES, A.NB_PROCSI_GEN, A.CD_PROCESO_GIS, B.CD_PARAMETRO \
					FROM ( \
					SELECT TGM105.NB_PARAM, TGM105.TX_PARAM, TGM105.CD_HABILITADO, TGM105.CD_PROCSI_GEN, NVL(TGM104.CD_PROCSI_RES,-1) CD_PROCSI_RES, \
					TGM104.NB_PROCSI_GEN, TGM033.CD_PROCESO_GIS, TGM105.NU_ORDEN  \
					FROM TGM105_PROCSI_SCR TGM105, TGM104_PROCSI_GEN TGM104, TGM033_PROCESO_GIS TGM033 \
					WHERE TGM105.CD_PROCSI_GEN = TGM104.CD_PROCSI_GEN               \
					AND TGM033.CD_PROCSI_GEN = TGM104.CD_PROCSI_GEN                 \
					AND TGM033.CD_PROCSI_GEN = TGM105.CD_PROCSI_GEN                 \
				  	AND TGM033.CD_PROCESO_GIS = ?  								    \
					) A, tgm046_param_cfg B                                         \
					WHERE A.CD_PROCESO_GIS = B.CD_PROCESO_GIS                       \
					AND A.NB_PARAM = B.NB_PARAM_CFG ORDER BY NU_ORDEN               

				
getProcesoNombre = SELECT NB_PROCSI_GEN FROM TGM104_PROCSI_GEN WHERE CD_PROCSI_GEN = ?

getNumNombre = SELECT COUNT(NB_PROCESO_GIS) FROM TGM033_PROCESO_GIS WHERE NB_PROCESO_GIS LIKE ?

getProcesoNombreSalida = SELECT NB_PROCSI_GEN FROM TGM104_PROCSI_GEN WHERE CD_PROCSI_GEN IN ( SELECT CD_PROCSI_RES FROM TGM104_PROCSI_GEN WHERE CD_PROCSI_GEN = ? )

getProcsiGen = SELECT CD_PROCSI_GEN FROM TGM033_PROCESO_GIS WHERE CD_PROCESO_GIS = ?

getProcesoNombreEdit = SELECT A.NB_PROCESO_GIS FROM TGM033_PROCESO_GIS A, TGM104_PROCSI_GEN B WHERE A.CD_PROCSI_GEN = B.CD_PROCSI_GEN AND A.CD_PROCESO_GIS = ?

getProcesoNombreSalidaEdit = SELECT NB_PROCESO_GIS FROM TGM033_PROCESO_GIS WHERE CD_PROCESO_GIS_RES = ?

getNombreProcesoSalida = SELECT NB_PROCESO_GIS FROM TGM033_PROCESO_GIS WHERE CD_PROCESO_GIS = ?

getPaisNombre = SELECT NB_PAIS FROM TGM006_PAIS WHERE CD_PAIS = ?				

getSearchProceso = SELECT COUNT(*) FROM TGM033_PROCESO_GIS WHERE NB_PROCESO_GIS = ? AND CD_ACTIVO = 1

getSearchProcesoUpdate = SELECT COUNT(*) FROM TGM033_PROCESO_GIS WHERE NB_PROCESO_GIS = ? AND CD_PROCESO_GIS NOT IN (SELECT CD_PROCESO_GIS FROM TGM033_PROCESO_GIS WHERE NB_PROCESO_GIS = ? AND CD_PROCESO_GIS = ? ) \
						 AND CD_PROCESO_GIS NOT IN (SELECT CD_PROCESO_GIS FROM TGM033_PROCESO_GIS WHERE NB_PROCESO_GIS = ? AND CD_PROCESO_GIS_RES = ? ) AND CD_ACTIVO = 1

getSearchProcesoUpdateResp = SELECT COUNT(*) FROM TGM033_PROCESO_GIS WHERE NB_PROCESO_GIS = ? AND CD_PROCESO_GIS_RES = ?

getBuscaNombre = SELECT COUNT(NB_PROCESO_GIS) FROM TGM033_PROCESO_GIS WHERE CD_ACTIVO = 1 AND NB_PROCESO_GIS LIKE ?

getBuscaNombreProceso = SELECT NB_PROCESO_GIS FROM TGM033_PROCESO_GIS WHERE NB_PROCESO_GIS LIKE ? AND CD_ACTIVO = 1 ORDER BY 1

getSearchProceso2 = SELECT COUNT(*) FROM tgm046_param_cfg WHERE NB_PARAM_CFG = ?

getSEQProceso = SELECT MAX(CD_PROCESO_GIS) + 1 MAX FROM TGM033_PROCESO_GIS

getSEQProcesoCFG = SELECT CD_PARAMETRO FROM tgm046_param_cfg WHERE NB_PARAM_CFG = ?			

getCdProcsiGen = SELECT CD_PROCSI_GEN FROM TGM104_PROCSI_GEN WHERE CD_PROCSI_GEN = ?

getCdProcsiGen2 = SELECT CD_PROCSI_RES FROM TGM104_PROCSI_GEN WHERE CD_PROCSI_GEN = ?	

getProcesosSelList = SELECT A.CD_PROCESO_GIS, A.NB_PROCESO_GIS FROM TGM033_PROCESO_GIS A, TGM104_PROCSI_GEN B WHERE A.CD_PROCSI_GEN = B.CD_PROCSI_GEN AND CD_ACTIVO = 1 ORDER BY A.NB_PROCESO_GIS

updateProcesoNombre33 = UPDATE TGM033_PROCESO_GIS SET NB_PROCESO_GIS = ? WHERE CD_PROCESO_GIS = ?

updateProcesoNombreSalida33 = UPDATE TGM033_PROCESO_GIS SET NB_PROCESO_GIS = ? WHERE CD_PROCESO_GIS_RES = ? 

updateProcesoNombre46 = UPDATE tgm046_param_cfg SET NB_PARAM_CFG = ? WHERE CD_PARAMETRO = ?

getIdProcesoNombre46 = SELECT a.cd_parametro FROM tgm046_param_cfg A, TGM033_PROCESO_GIS B WHERE A.CD_PROCESO_GIS = B.CD_PROCESO_GIS AND B.CD_PROCESO_GIS = ? AND TX_VALOR IS NULL

getIdProcesoNombreSalida46 = SELECT a.cd_parametro FROM tgm046_param_cfg A, TGM033_PROCESO_GIS B WHERE A.CD_PROCESO_GIS = B.CD_PROCESO_GIS AND B.CD_PROCESO_GIS_RES = ? AND TX_VALOR IS NULL

getIdProcesoNombreParams46 = SELECT A.CD_PARAMETRO FROM tgm046_param_cfg A, TGM033_PROCESO_GIS B WHERE A.CD_PROCESO_GIS = B.CD_PROCESO_GIS AND B.CD_PROCSI_GEN = ? AND A.NB_PARAM_CFG = ?

getIdProcesoNombreParamsSalida46 = SELECT A.CD_PARAMETRO FROM tgm046_param_cfg A, TGM033_PROCESO_GIS B WHERE A.CD_PROCESO_GIS = B.CD_PROCESO_GIS AND    B.CD_PROCSI_GEN = ( SELECT CD_PROCSI_RES FROM TGM104_PROCSI_GEN WHERE CD_PROCSI_GEN = ? ) AND A.NB_PARAM_CFG = ?

getIdProcesoHijo = SELECT * FROM TGM033_PROCESO_GIS WHERE  CD_PROCESO_GIS_RES IS NOT NULL CONNECT BY PRIOR CD_PROCESO_GIS_RES = CD_PROCESO_GIS START WITH CD_PROCESO_GIS_RES =  ?

getIdProcesoPropuesto = SELECT CD_PROCSI_RES FROM TGM104_PROCSI_GEN WHERE CD_PROCSI_GEN = ( SELECT A.CD_PROCSI_GEN FROM TGM033_PROCESO_GIS A, TGM104_PROCSI_GEN B WHERE A.CD_PROCSI_GEN = B.CD_PROCSI_GEN AND A.CD_PROCESO_GIS = ? )
 
getIdProcesoRespuestaUpdate = SELECT CD_PROCESO_GIS FROM TGM033_PROCESO_GIS WHERE CD_PROCESO_GIS_RES = ? AND CD_ACTIVO = 1
  
getIdInstancia = SELECT CD_PARAMETRO FROM tgm046_param_cfg WHERE NB_PARAM_CFG = 'NB_CONFIG_PROCESO_SI'

getRespuesta = SELECT COUNT(CD_PROCESO_GIS) FROM (SELECT B.CD_PROCESO_GIS FROM TGM033_PROCESO_GIS A, TGM033_PROCESO_GIS B WHERE A.CD_PROCESO_GIS = B.CD_PROCESO_GIS_RES AND   A.CD_PROCESO_GIS = ? AND A.CD_ACTIVO = B.CD_ACTIVO AND B.CD_ACTIVO = 1)

getRespuestaParam = SELECT NVL(CD_PROCSI_RES,0) CD_PROCSI_RES FROM TGM104_PROCSI_GEN WHERE CD_PROCSI_GEN = ?

getCdProcsiRes = SELECT B.CD_PROCSI_RES FROM TGM033_PROCESO_GIS A, TGM104_PROCSI_GEN B WHERE a.cd_procsi_gen = b.cd_procsi_gen AND a.cd_proceso_gis = ?

getPaisResp = SELECT CD_PAIS FROM TGM033_PROCESO_GIS WHERE CD_PROCESO_GIS = ?

getCdProcesoGIS = SELECT CD_PROCESO_GIS FROM TGM033_PROCESO_GIS WHERE NB_PROCESO_GIS = ? AND CD_ACTIVO = 1

getDeleteCdProcsiGis = SELECT CD_PROCESO_GIS FROM TGM033_PROCESO_GIS WHERE CD_PROCESO_GIS_RES = ? AND CD_ACTIVO = 1

getDeleteProcTGM033 = UPDATE TGM033_PROCESO_GIS SET CD_ACTIVO = 0 WHERE CD_PROCESO_GIS = ?  

getDeleteProcTGM046 = SELECT CD_PARAMETRO FROM TGM046_PARAM_CFG WHERE CD_PROCESO_GIS = ? AND NB_PARAM_CFG = ?

getProcesoCdTipoProcsi = SELECT NVL(B.CD_PROCSI_RES,0) FROM TGM033_PROCESO_GIS A, TGM104_PROCSI_GEN B WHERE A.CD_PROCSI_GEN = B.CD_PROCSI_GEN AND A.CD_PROCESO_GIS = ?
 

########DIRECTORIO##############

getDirectory = SELECT * FROM TGM065_DIRECTORIO ORDER BY NB_PAIS

getDirectory1 = SELECT CD_DIRECTORIO, NB_AREA, NB_USUARIO, B.NB_PAIS, NB_TELEFONO, NB_CORREO_ELECT, NB_BANCO, NB_EXTENSION, TP_IDENTIFICADOR FROM TGM065_DIRECTORIO A, TGM006_PAIS B WHERE A.NB_PAIS = B.TX_PAIS AND TP_IDENTIFICADOR = 3 ORDER BY B.NB_PAIS 

getDirectory2 = SELECT * FROM TGM065_DIRECTORIO WHERE TP_IDENTIFICADOR = 1 ORDER BY NB_PAIS 

getDirectory3 = SELECT CD_DIRECTORIO, NB_AREA, NB_USUARIO, B.NB_PAIS, NB_TELEFONO, NB_CORREO_ELECT, NB_BANCO, NB_EXTENSION, TP_IDENTIFICADOR FROM TGM065_DIRECTORIO A, TGM006_PAIS B WHERE A.NB_PAIS = B.TX_PAIS AND TP_IDENTIFICADOR = 2 ORDER BY B.NB_PAIS 

getDirectorySearch = SELECT * FROM TGM065_DIRECTORIO WHERE NB_USUARIO = ?

updateProceso46 = 	UPDATE TGM046_PARAM_CFG SET TX_VALOR = ? where CD_PARAMETRO = ?
########DIRECTORIO##############

getDirectory = SELECT * FROM TGM065_DIRECTORIO ORDER BY NB_PAIS

getDirectory1 = SELECT CD_DIRECTORIO, NB_AREA, NB_USUARIO, B.NB_PAIS, NB_TELEFONO, NB_CORREO_ELECT, NB_BANCO, NB_EXTENSION, TP_IDENTIFICADOR FROM TGM065_DIRECTORIO A, TGM006_PAIS B WHERE A.NB_PAIS = B.TX_PAIS AND TP_IDENTIFICADOR = 3 ORDER BY B.NB_PAIS 

getDirectory2 = SELECT * FROM TGM065_DIRECTORIO WHERE TP_IDENTIFICADOR = 1 ORDER BY NB_PAIS 

getDirectory3 = SELECT CD_DIRECTORIO, NB_AREA, NB_USUARIO, B.NB_PAIS, NB_TELEFONO, NB_CORREO_ELECT, NB_BANCO, NB_EXTENSION, TP_IDENTIFICADOR FROM TGM065_DIRECTORIO A, TGM006_PAIS B WHERE A.NB_PAIS = B.TX_PAIS AND TP_IDENTIFICADOR = 2 ORDER BY B.NB_PAIS 

getDirectorySearch = SELECT * FROM TGM065_DIRECTORIO WHERE NB_USUARIO = ?

getPaisesDir = SELECT NB_PAIS, TX_PAIS FROM TGM006_PAIS ORDER BY NB_PAIS


######## REQUERIMIENTOS ##############

getAmbito = SELECT CD_TP_AMBITO, NB_TP_AMBITO FROM TGM062_TP_AMBITO ORDER BY NB_TP_AMBITO 

getRequerimientos = SELECT CD_REQUERIMIENTO, NB_REQUERIMIENTO, NB_TP_AMBITO, TX_PAIS, \
					CD_ST_REQUERIMIEN, TX_REQUERIMIENTO, A.CD_PAIS, A.CD_TP_AMBITO FROM TGM074_REQUERIMIEN A, TGM006_PAIS B, TGM062_TP_AMBITO C \
					WHERE A.CD_PAIS = B.CD_PAIS  AND A.CD_TP_AMBITO = C.CD_TP_AMBITO \

getRequerimientosSearch = SELECT CD_REQUERIMIENTO, NB_REQUERIMIENTO, NB_TP_AMBITO, TX_PAIS, \
					CD_ST_REQUERIMIEN, TX_REQUERIMIENTO, A.CD_PAIS, A.CD_TP_AMBITO FROM TGM074_REQUERIMIEN A, TGM006_PAIS B, TGM062_TP_AMBITO C \
					WHERE A.CD_PAIS = B.CD_PAIS  AND A.CD_TP_AMBITO = C.CD_TP_AMBITO AND A.NB_REQUERIMIENTO = ?\


getPaisesReq = SELECT CD_PAIS, TX_PAIS FROM TGM006_PAIS ORDER BY NB_PAIS

###############Actualiza una cuenta relay por id de cliente##################

updateRelayAcount  = UPDATE TGM030_CTA_RELAY \
SET    CD_CTA_RELAY    = ?, \
       NB_BIC_RELAY    = ?, \
       TM_MODIFICACION = sysdate \
		WHERE  CD_CLIENTE      = ? \
		AND    TRIM(CD_CTA_RELAY)    = ?
		
getProductsByUser = SELECT \
        				PRODUCT.CD_PRD_CONTRATADO, PRODUCT.TX_PROD_CONTRATADO \
					FROM \
        				TGM014_CTE_PRODCON CLIENTE, \
        				TGM013_PROD_CONTRA PRODUCT  \
        			WHERE \
        				CLIENTE.CD_CLIENTE = ? AND \
        				CLIENTE.CD_PRD_CONTRATADO = PRODUCT.CD_PRD_CONTRATADO \
        				AND PRODUCT.CD_PAIS = ?
        				
getProductsTable = SELECT CD_PRD_CONTRATADO, TX_PROD_CONTRATADO FROM TGM013_PROD_CONTRA WHERE CD_ACTIVO =1 AND CD_PAIS=?

#####################queries para la bitacora de procesoss
getEvents = SELECT CD_TP_EVENTO, TX_TP_EVENTO FROM TGM047_TP_EVENTO

getProcessNames = SELECT CD_PROCESO_GIS, NB_PROCESO_GIS, CD_ACTIVO FROM TGM033_PROCESO_GIS WHERE CD_ACTIVO = 1 \
				  ORDER BY NB_PROCESO_GIS

getProcessByDay = SELECT \
					BITACORA.CD_PROCESO_LOG, \
					BITACORA.CD_TP_EVENTO,	\
					EVENTO.TX_TP_EVENTO,	\
					BITACORA.CD_PROCESO_GIS, \
					GIS.NB_PROCESO_GIS, \
					BITACORA.TX_PROCESO_LOG, \
					BITACORA.TM_PROCESO_LOG	 \
				FROM \
					TGM048_PROCESO_LOG BITACORA, \
					TGM047_TP_EVENTO EVENTO,	\
					TGM033_PROCESO_GIS GIS \
				WHERE	\
					BITACORA.CD_TP_EVENTO = EVENTO.CD_TP_EVENTO \
					AND \
					BITACORA.CD_PROCESO_GIS = GIS.CD_PROCESO_GIS \
					AND \
					TO_CHAR(BITACORA.TM_PROCESO_LOG,'dd-mm-YYYY') = ? ORDER BY  TM_PROCESO_LOG DESC
					
getProcessFilters = SELECT \
					BITACORA.CD_PROCESO_LOG, \
					BITACORA.CD_TP_EVENTO,	\
					EVENTO.TX_TP_EVENTO,	\
					BITACORA.CD_PROCESO_GIS, \
					GIS.NB_PROCESO_GIS, \
					BITACORA.TX_PROCESO_LOG, \
					BITACORA.TM_PROCESO_LOG	 \
				FROM \
					TGM048_PROCESO_LOG BITACORA, \
					TGM047_TP_EVENTO EVENTO,	\
					TGM033_PROCESO_GIS GIS \
				WHERE	\
					BITACORA.CD_TP_EVENTO = EVENTO.CD_TP_EVENTO \
					AND \
					BITACORA.CD_PROCESO_GIS = GIS.CD_PROCESO_GIS

###########################################################################
##################Relationship customer mask###############################
###########################################################################

getCustomerByMask = SELECT \
						CLIENTE.CD_CLIENTE, \
						CLIENTE.NB_CLIENTE, \
						CLIENTE.CD_REFERENCIA, \
						SERVICIO.CD_TP_SERVICIO, \
    					(SELECT TPSERVICIO.NB_TP_SERVICIO FROM TGM002_SERVICIO TPSERVICIO WHERE TPSERVICIO.CD_TP_SERVICIO = SERVICIO.CD_TP_SERVICIO) NB_TP_SERVICIO, \
    					(SELECT PAIS.CD_PAIS FROM TGM006_PAIS PAIS WHERE PAIS.CD_PAIS = CLIENTE.CD_PAIS)CD_PAIS, \
    					(SELECT PAIS.NB_PAIS ||'-'|| PAIS.TX_PAIS FROM TGM006_PAIS PAIS WHERE PAIS.CD_PAIS = CLIENTE.CD_PAIS)NB_PAIS, \
    					(SELECT MASC.CD_TP_ARCHIVO FROM TGM011_ARCH_PRC MASC WHERE MASC.CD_CLIENTE=CLIENTE.CD_CLIENTE AND CLIENTE.CD_PAIS=MASC.CD_PAIS AND SERVICIO.CD_TP_SERVICIO = MASC.CD_TP_SERVICIO) CD_TP_ARCHIVO, \
    					(SELECT MASC.NB_TP_ARCHIVO FROM TGM011_ARCH_PRC MASC WHERE MASC.CD_CLIENTE=CLIENTE.CD_CLIENTE AND CLIENTE.CD_PAIS=MASC.CD_PAIS AND SERVICIO.CD_TP_SERVICIO = MASC.CD_TP_SERVICIO)  NB_TP_ARCHIVO, \
    					 (SELECT MASC.NB_MASC_ARCHIVO FROM TGM011_ARCH_PRC MASC WHERE MASC.CD_CLIENTE=CLIENTE.CD_CLIENTE AND CLIENTE.CD_PAIS=MASC.CD_PAIS AND SERVICIO.CD_TP_SERVICIO = MASC.CD_TP_SERVICIO)  NB_MASC_ARCHIVO \
    				FROM \
    					TGM001_CLIENTE CLIENTE, \
    					TGM004_CTE_SERV SERVICIO \
    				WHERE \
    					CLIENTE.CD_CLIENTE = SERVICIO.CD_CLIENTE \
    					AND SERVICIO.CD_TP_SERVICIO <> 3
    					
###########################################################################
##################Update mask by customer##################################
###########################################################################

updateMaskByCustomer = UPDATE \
							TGM011_ARCH_PRC \
						SET \
						 	NB_MASC_ARCHIVO   = ? \
						WHERE \
							CD_CLIENTE        = ? \
							AND \
							CD_TP_ARCHIVO     = ? \
							AND \
							CD_TP_SERVICIO  =	?

###########################################################################
##################Update mask description by customer######################
###########################################################################

updateMaskDByCustomer = UPDATE \
							TGM011_ARCH_PRC \
						SET \
						 	NB_TP_ARCHIVO   = ? \
						WHERE \
							CD_CLIENTE        = ? \
							AND \
							CD_TP_ARCHIVO     = ? \
							AND \
							CD_TP_SERVICIO  =	?							
							

###########################################################################
##################delete mask by customer##################################
###########################################################################							
deleteMask = DELETE FROM TGM011_ARCH_PRC WHERE CD_CLIENTE = ? AND CD_TP_SERVICIO = ? AND CD_TP_ARCHIVO = ?


###########################################################################
##################insert mask by customer##################################
###########################################################################
inserMask = INSERT INTO \
				TGM011_ARCH_PRC ( \
						CD_TP_SRV_SWIFT, \
						CD_PAIS, \
						CD_TP_SERVICIO, \
						NB_MASC_ARCHIVO, \
						CD_CLIENTE, \
						CD_MULTIPLE) \
						VALUES (?,? ,? ,? ,? ,? ,? )
						
						
###########################################################################
##################TABLE maskS by customer PAYS#############################
###########################################################################

getTableCustomerMaskPays = SELECT \
								CLIENTE.CD_CLIENTE, 																		\
								CLIENTE.NB_CLIENTE, 																		\
								CLIENTE.CD_REFERENCIA, 																		\
								SERVICIO.CD_TP_SERVICIO, 																	\
								TPSERVICIO.NB_TP_SERVICIO, 																	\
								PAIS.CD_PAIS, 																				\
								PAIS.NB_PAIS || '-' || PAIS.TX_PAIS NB_PAIS, 												\
     							MASC.CD_TP_ARCHIVO, 																		\
							  	MASC.NB_TP_ARCHIVO, 																		\
     							MASC.NB_MASC_ARCHIVO, 																		\
							  	PRODUCTO.CD_PRD_CONTRATADO, 																\
                				PRODUCTO.NB_PROD_CONTRATADO 																	\
							FROM TGM001_CLIENTE CLIENTE 																	\
              				INNER JOIN TGM004_CTE_SERV SERVICIO ON CLIENTE.CD_CLIENTE = SERVICIO.CD_CLIENTE 				\
              				INNER JOIN TGM002_SERVICIO TPSERVICIO ON TPSERVICIO.CD_TP_SERVICIO = SERVICIO.CD_TP_SERVICIO 	\
              				INNER JOIN TGM006_PAIS PAIS ON CLIENTE.CD_PAIS = PAIS.CD_PAIS 									\
              				INNER JOIN TGM011_ARCH_PRC MASC ON MASC.CD_CLIENTE = CLIENTE.CD_CLIENTE 						\
              				LEFT JOIN TGM013_PROD_CONTRA PRODUCTO ON MASC.CD_PRD_CONTRATADO = PRODUCTO.CD_PRD_CONTRATADO 	\
							WHERE SERVICIO.CD_TP_SERVICIO=3
							
verifyCustomer = SELECT * FROM TGM001_CLIENTE WHERE NB_CLIENTE = ? AND CD_REFERENCIA = ? AND CD_PAIS=?

###########################################################################
###################queries para el catalogo de noticias####################
###########################################################################

## YA990I INICIO..
##Se agrego la columna BL_IMAGEN en el query 
##
ListNews = SELECT \
			CD_NOTICIA, \
			TX_NOTICIA, \
			TX_CONTENIDO, \
			NU_ORDEN, \
			TM_ALTA, \
			BL_IMAGEN  \
			FROM TGM066_NOTICIA ORDER BY NU_ORDEN
			
## YA990I FIN..
##Se agrego la columna BL_IMAGEN en el query 
##		
getImageNewsById= SELECT \
				BL_IMAGEN \
				FROM TGM066_NOTICIA WHERE CD_NOTICIA=?
				
saveNews = CALL SP_GM066_INS_NOTICIA(?,?)

getNewsById = SELECT \
			CD_NOTICIA, \
			TX_NOTICIA, \
			TX_CONTENIDO, \
			BL_IMAGEN, \
			NU_ORDEN, \
			TM_ALTA \
			FROM TGM066_NOTICIA WHERE CD_NOTICIA = ? FOR UPDATE

updateTitleNews = UPDATE TGM066_NOTICIA SET TX_NOTICIA=? where CD_NOTICIA=?

updateContentNews = UPDATE TGM066_NOTICIA SET TX_CONTENIDO=? where CD_NOTICIA=?

updateOrderNews = UPDATE TGM066_NOTICIA SET NU_ORDEN=? where CD_NOTICIA=?

deleteNews = DELETE FROM TGM066_NOTICIA WHERE CD_NOTICIA = ?

emptyBlobNewsById = UPDATE TGM066_NOTICIA SET BL_IMAGEN=empty_Blob() where CD_NOTICIA=?
BlobNewsById = UPDATE TGM066_NOTICIA SET BL_IMAGEN=? where CD_NOTICIA=?
 
countNews = select count(DISTINCT(cd_noticia)) cont_noticias from tgm066_noticia

#################################################################
#############busqueda de monedas#################################
#################################################################
searchCoins = SELECT \
				MONEDA.CD_MONEDA_SW, MONEDA.NB_MONEDA_SW, MONEDA.NU_DIGITO_FRAC, MONEDA.CD_PAIS_SW, PAIS.NB_PAIS_SW \
			  FROM TGM069_MONEDA_SWIFT MONEDA INNER JOIN TGM068_PAIS_SWIFT PAIS ON MONEDA.CD_PAIS_SW = PAIS.CD_PAIS_SW \
			  WHERE UPPER(MONEDA.CD_MONEDA_SW) LIKE UPPER(?) AND UPPER(MONEDA.NB_MONEDA_SW) LIKE UPPER(?) \
			  AND UPPER(MONEDA.CD_PAIS_SW) LIKE UPPER(?)  AND UPPER(PAIS.NB_PAIS_SW) LIKE UPPER(?)

#################################################################
#############busqueda de bics ###################################
#################################################################
searchBics = SELECT 			\
				CD_BIC_ABA,		\
				CD_ABA,			\
				CD_BIC_SW,		\
				TX_BANCO,		\
				NB_PAIS,		\
				NB_CIUDAD,		\
				A.CD_PAIS_SW,	\
				B.NB_PAIS_SW 	\
			FROM \
				TGM036_BIC_ABA A,\
				TGM068_PAIS_SWIFT B \
			WHERE \
				A.CD_PAIS_SW = B.CD_PAIS_SW
#################################################################
#############Query para obtener bitacora Archivos################
#################################################################
getLogFiles = select   \
				btarch.CD_ARCH_PROCESADO, \
			    btarch.CD_TP_ARCHIVO, \
			    btarch.CD_ST_ARCHIVO, \
			    btarch.TP_ENT_SAL_BBVA, \
			    btarch.NB_ARCH_PROCESADO, \
			    btarch.TM_PROCESO, \
			    starch.NB_ST_ARCHIVO, \
			    ctarch.nb_masc_archivo, \
			    ctarch.CD_TP_SRV_SWIFT, \
			    ctarch.CD_PAIS, \
			    ctarch.CD_TP_SERVICIO, \
			    (select pais.TX_PAIS from TGM006_PAIS pais where UPPER(btarch.CD_PAIS)=UPPER(pais.NB_PAIS)), \
			    (select srvswift.NB_TP_SRV_SWIFT from TGM007_SRV_SWIFT srvswift where ctarch.CD_TP_SRV_SWIFT=srvswift.CD_TP_SRV_SWIFT), \
			    (select srv.NB_TP_SERVICIO from TGM002_SERVICIO srv where srv.CD_TP_SERVICIO= ctarch.CD_TP_SERVICIO),  \
			    flujo.NB_FLUJO_BBVA, \
			     btarch.CD_PAIS, \
                btarch.CD_BIC, \
                TO_DATE(CAST(btarch.TM_PROCESO AS DATE),'DD/MM/RRRR') FECHA \
                	from \
                    	TGM009_ARCHPRC_LOG btarch, \
                    	TGM010_ST_ARCHIVO starch, \
                    	TGM011_ARCH_PRC ctarch, \
                        TGM002_SERVICIO srv, \
                        TGM059_FLUJO_BBVA flujo \
                	where \
                     btarch.CD_ST_ARCHIVO=starch.CD_ST_ARCHIVO and \
                     btarch.CD_TP_ARCHIVO=ctarch.CD_TP_ARCHIVO and \
                     ctarch.CD_TP_SERVICIO=srv.CD_TP_SERVICIO and \
                     flujo.TP_ENT_SAL_BBVA = btarch.TP_ENT_SAL_BBVA and
                     
getOutputFilesRecaudosConsultasRelay = SELECT \
                                            LOG1.CD_ARCH_PROCESADO,\
                                            LOG1.NB_ARCH_PROCESADO,\
                                            LOG1.CD_PAIS,\
                                            LOG1.CD_BIC,\
                                            ST.CD_ST_ARCHIVO,\
                                            ST.NB_ST_ARCHIVO,\
                                            PRC.CD_TP_ARCHIVO,\
                                            PRC.NB_TP_ARCHIVO,\
                                            PRC.NB_MASC_ARCHIVO,\
                                            PRC.CD_PAIS,\
                                            UPPER(LOG1.CD_PAIS),\
                                            FLW.TP_ENT_SAL_BBVA,\
                                            FLW.NB_FLUJO_BBVA,\
                                            SRV.CD_TP_SERVICIO,\
                                            SRV.NB_TP_SERVICIO,\
                                            CNL.CD_TP_CANAL,\
                                            CNL.NB_CANAL,\
                                            CNL.TX_CANAL,\
                                            SWT.CD_TP_SRV_SWIFT,\
                                            SWT.NB_TP_SRV_SWIFT,\
                                            TO_CHAR(TM_PROCESO,'dd-mm-YYYY hh24:mi') TM_ALTA_CHAR,\
                                            LOG1.TM_PROCESO \
                                        FROM TGM009_ARCHPRC_LOG LOG1 \
                                        INNER JOIN TGM010_ST_ARCHIVO ST  ON LOG1.CD_ST_ARCHIVO = ST.CD_ST_ARCHIVO \
                                        INNER JOIN TGM011_ARCH_PRC   PRC ON LOG1.CD_TP_ARCHIVO = PRC.CD_TP_ARCHIVO \
                                        INNER JOIN TGM059_FLUJO_BBVA FLW ON LOG1.TP_ENT_SAL_BBVA = FLW.TP_ENT_SAL_BBVA AND LOG1.TP_ENT_SAL_BBVA = ? \
                                        INNER JOIN TGM002_SERVICIO   SRV ON SRV.CD_TP_SERVICIO = PRC.CD_TP_SERVICIO AND SRV.CD_TP_SERVICIO = ? \
                                        INNER JOIN TGM003_CANAL      CNL ON CNL.CD_TP_CANAL = SRV.CD_TP_CANAL \
                                        INNER JOIN TGM007_SRV_SWIFT  SWT ON SWT.CD_TP_SRV_SWIFT = PRC.CD_TP_SRV_SWIFT \
                                        WHERE LOG1.TM_PROCESO BETWEEN TO_DATE(?,'dd-mm-YYYY') AND TO_DATE(?,'dd-mm-YYYY')+1 \
                                        AND UPPER(LOG1.CD_BIC) LIKE UPPER(?) \
                                        ORDER BY LOG1.TM_PROCESO DESC
                                        
getOutputFilesRecaudosConsultasRelayXPais =  SELECT \
                                            LOG1.CD_ARCH_PROCESADO,\
                                            LOG1.NB_ARCH_PROCESADO,\
                                            LOG1.CD_PAIS,\
                                            LOG1.CD_BIC,\
                                            ST.CD_ST_ARCHIVO,\
                                            ST.NB_ST_ARCHIVO,\
                                            PRC.CD_TP_ARCHIVO,\
                                            PRC.NB_TP_ARCHIVO,\
                                            PRC.NB_MASC_ARCHIVO,\
                                            PRC.CD_PAIS,\
                                            UPPER(LOG1.CD_PAIS),\
                                            FLW.TP_ENT_SAL_BBVA,\
                                            FLW.NB_FLUJO_BBVA,\
                                            SRV.CD_TP_SERVICIO,\
                                            SRV.NB_TP_SERVICIO,\
                                            CNL.CD_TP_CANAL,\
                                            CNL.NB_CANAL,\
                                            CNL.TX_CANAL,\
                                            SWT.CD_TP_SRV_SWIFT,\
                                            SWT.NB_TP_SRV_SWIFT,\
                                            TO_CHAR(TM_PROCESO,'dd-mm-YYYY hh24:mi') TM_ALTA_CHAR,\
                                            LOG1.TM_PROCESO \
                                        FROM TGM009_ARCHPRC_LOG LOG1 \
                                        INNER JOIN TGM010_ST_ARCHIVO ST  ON LOG1.CD_ST_ARCHIVO = ST.CD_ST_ARCHIVO \
                                        INNER JOIN TGM011_ARCH_PRC   PRC ON LOG1.CD_TP_ARCHIVO = PRC.CD_TP_ARCHIVO \
                                        INNER JOIN TGM059_FLUJO_BBVA FLW ON LOG1.TP_ENT_SAL_BBVA = FLW.TP_ENT_SAL_BBVA AND LOG1.TP_ENT_SAL_BBVA = ? \
                                        INNER JOIN TGM002_SERVICIO   SRV ON SRV.CD_TP_SERVICIO = PRC.CD_TP_SERVICIO AND SRV.CD_TP_SERVICIO = ? \
                                        INNER JOIN TGM003_CANAL      CNL ON CNL.CD_TP_CANAL = SRV.CD_TP_CANAL \
                                        INNER JOIN TGM007_SRV_SWIFT  SWT ON SWT.CD_TP_SRV_SWIFT = PRC.CD_TP_SRV_SWIFT \
                                        WHERE LOG1.TM_PROCESO BETWEEN TO_DATE(?,'dd-mm-YYYY') AND TO_DATE(?,'dd-mm-YYYY')+1 AND UPPER(LOG1.CD_PAIS) = UPPER(?) \
                                        AND UPPER(LOG1.CD_BIC) LIKE UPPER(?) \
                                        ORDER BY LOG1.TM_PROCESO DESC                                       

#########Obtine un usuario por id, para validar solo datos de contrasea								    
getUserById = SELECT CD_CLAVE_USUARIO, CD_CONTRASENIA,TM_CAMBIO_CNTRASEN, TO_CHAR(TM_ULTIMO_ACCESO,'dd-mm-YYYY') FROM TGM023_USUARIO A WHERE A.CD_USUARIO = ?

#########Obtiene la lista de eventos del calendario por fecha								    
getCalendarEvents = select CD_EVENTO, NB_EVENTO, TO_CHAR(TM_EVENTO,'dd-mm-YYYY'), TM_EVENTO C from tgm049_calendario where tm_evento = TO_DATE(?,'dd-mm-YYYY') ORDER BY C


#########Obtiene la lista de todas las fechas que tenemos que marcar en el calendario como verdes, que signica que hay cambios								    
getDistinctEventDates = SELECT DISTINCT(TO_CHAR(TM_EVENTO,'dd-mm-YYYY'))FECHAS FROM TGM049_CALENDARIO ORDER BY FECHAS

####Obtiene la lista de preguntas para la evalucacion###########################
getAllQuestions = SELECT * FROM TGM073_PREGUNTA WHERE CD_PREGUNTA_ACTIVA = '1'

####Obtiene la lista de los valores del rating para la evalucacion###########################
getratingValues = SELECT * FROM TGM070_EVALUACION

#### obtiene la puntuacion por respuesta de cada pregunta
getSumRating = SELECT  \
    				SUM(PUNTOS.CD_EVALUACION) AS RATING, \
    				(SELECT PREGUNTA.NB_EVALUACION FROM TGM073_PREGUNTA PREGUNTA WHERE PREGUNTA.CD_PREGUNTA=PUNTOS.CD_PREGUNTA) AS PREGUNTA \
				FROM \
					TGM071_PUNTUACION PUNTOS \
					GROUP BY PUNTOS.CD_PREGUNTA
					
###obtine el total de puntos de todas las encuestas
getTotalRating = SELECT SUM(PUNTOS.CD_EVALUACION) FROM TGM071_PUNTUACION PUNTOS

##Obtiene la lista de productos contratados con la relacion de pais que tiene
getProductsPais = SELECT PROD.CD_PRD_CONTRATADO,PROD.NB_PROD_CONTRATADO, PROD.TX_PROD_CONTRATADO, PROD.CD_ACTIVO, PAIS.CD_PAIS, PAIS.TX_PAIS FROM TGM013_PROD_CONTRA PROD INNER JOIN TGM006_PAIS PAIS ON PROD.CD_PAIS=PAIS.CD_PAIS WHERE cd_activo=1 ORDER BY PAIS.CD_PAIS


###Query para obtener el cliente al que va destinado un archivo segun su bic y pais del archivo procesado.
getClientSendFile = SELECT \
    						NB_CLIENTE,BICS.NB_BIC_SW_CTE, PAISES.NB_PAIS \
					FROM TGM001_CLIENTE CLIENTE \
					INNER JOIN TGM031_BIC_CLIENTE BICS ON BICS.CD_BIC_SW_CTE = CLIENTE.CD_BIC_SW_CTE \
					INNER JOIN TGM006_PAIS PAISES ON PAISES.CD_PAIS = CLIENTE.CD_PAIS \
					WHERE PAISES.NB_PAIS=upper(?) AND BICS.NB_BIC_SW_CTE =  upper(?)
					
getAmbitosValues = SELECT * FROM TGM062_TP_AMBITO

getRequerimientosValues = SELECT * FROM TGM074_REQUERIMIEN WHERE CD_TP_AMBITO = ? ORDER BY nb_requerimiento

getCdPuntuacion = SELECT CD_PUNTUACION FROM TGM071_PUNTUACION WHERE CD_REQUERIMIENTO = ? AND TX_COMENTARIO = ? AND CD_USUARIO = ?

insertValoracion = INSERT INTO TGM075_VALORACION (CD_PUNTUACION, CD_PREGUNTA, CD_EVALUACION) VALUES (?, ?, ?)

getPaises = SELECT cd_pais, CONCAT(nb_pais, CONCAT (' - ', tx_pais)) FROM TGM006_PAIS \
			ORDER BY nb_pais
			
getPaisXCDPais = SELECT nb_pais FROM TGM006_PAIS WHERE cd_pais = ?

getDescripcionRequerimiento = SELECT tx_requerimiento FROM TGM074_REQUERIMIEN WHERE CD_REQUERIMIENTO = ?

desbloquearUsuario = UPDATE TGM023_USUARIO SET CT_LOGEO_ERRONEO = 0 WHERE CD_USUARIO = ?

getPaisCdCCR = SELECT PAIS.CD_PAIS FROM TGM006_PAIS PAIS WHERE UPPER(PAIS.NB_PAIS_CCR) = UPPER(?)

getCtsRelayXPaisCtaBicRelay = SELECT * \
								FROM TGM001_CLIENTE cte inner join TGM030_CTA_RELAY cta on cte.CD_CLIENTE = cta.CD_CLIENTE \
								WHERE   cta.CD_CTA_RELAY = ? AND \
        						cta.NB_BIC_RELAY = ? AND \
        						cte.CD_PAIS = ?
deleteCliente = delete from TGM001_CLIENTE where CD_CLIENTE = ?

getValorParametro = SELECT NB_VALOR FROM TGM112_PARAM_WEB WHERE NB_PARAMETRO = ?

##############################################################################################################
############################# ADMINISTRACION DE DIAS FERIADOS ################################################
##############################################################################################################

sprDiasFeriados = SELECT T106.CD_PROCSI_DIA_FER, T033.CD_PROCESO_GIS, TO_CHAR(T106.FH_DIA_FERIADO, 'DD-MM-YYYY') FH_DIA_FERIADO, \
				  T106.TX_DIA_FERIADO, T106.TP_CICLICO, T033.NB_PROCESO_GIS \
				  FROM TGM106_PROCSI_DFER T106 \
				  INNER JOIN TGM033_PROCESO_GIS T033 ON T106.CD_PROCESO_GIS = T033.CD_PROCESO_GIS

spiDiaFeriado = INSERT INTO TGM106_PROCSI_DFER(CD_PROCESO_GIS, FH_DIA_FERIADO, TX_DIA_FERIADO, TP_CICLICO) \
			    VALUES(?, TO_DATE(?, 'DD-MM-YYYY'), ?, ?)

spuDiaFeriado = UPDATE TGM106_PROCSI_DFER SET CD_PROCESO_GIS = ?, FH_DIA_FERIADO = TO_DATE(?, 'DD-MM-YYYY'), \
			    TX_DIA_FERIADO = ?, TP_CICLICO = ? WHERE CD_PROCSI_DIA_FER = ?

spdDiaFeriado = DELETE FROM TGM106_PROCSI_DFER WHERE CD_PROCSI_DIA_FER = ?

spiWebDiaFeriado = INSERT INTO TGM107_EVENTO_WEB(CD_USUARIO,  TX_EVENTO_WEB, TM_EVENTO_WEB)  \
			    VALUES(?, ?, SYSTIMESTAMP)
			    
getIdProceso = SELECT CD_PROCSI_DIA_FER FROM TGM106_PROCSI_DFER WHERE TX_DIA_FERIADO = ? AND FH_DIA_FERIADO = ? 			    

getNombreProceso = SELECT NB_PROCESO_GIS FROM TGM033_PROCESO_GIS WHERE CD_PROCESO_GIS = ?

getFechasProceso = SELECT B.NB_NOMBRE_USR || ' ' || B.NB_APELL_PAT || ' ' || B.NB_APELL_MAT NOMBRE, A.TX_EVENTO_WEB, A.TM_EVENTO_WEB \
					FROM TGM107_EVENTO_WEB A, TGM023_USUARIO B \
					WHERE A.CD_USUARIO = B.CD_USUARIO  \
					AND TO_DATE(TO_CHAR(A.TM_EVENTO_WEB, 'DD-MM-YYYY'), 'DD-MM-YYYY') BETWEEN TO_DATE(?, 'DD-MM-YYYY') AND TO_DATE(?, 'DD-MM-YYYY')
					
##############################################################################################################

tieneServicioDesbloqueo = SELECT * FROM TGM026_DESBLOQ_USR WHERE CD_USUARIO = ?

##########################################---RMA---###########################################################

getInstitucionesRma = {call PG_XX_RMA.SP_108S_COM_INST(?,?,?,?,?,?)}
				        
getPaisesRma = {call PG_XX_RMA.SP_108S_COM_PAIS(?,?,?,?,?,?)}
			    
getCiudadesRma = {call PG_XX_RMA.SP_108S_COMBO_CD(?,?,?,?,?,?)}
			    
getBicsRma =  {call PG_XX_RMA.SP_108S_CRMA_BIC(?,?,?,?,?,?)}
		    
getReporteRMA = {call PG_XX_RMA.SP_108S_REPO_RMA(?,?,?,?,?,?,?)}
				
deleteRma = {call PG_XX_RMA.SP_108D_BORA_RMA}

insertRma= {call PG_XX_RMA.SP_108I_INS_RMA(?,?,?,?)}
##################################################################----USUARIOS-----##########################
insertaUsuarios= {call PG_XX_USUARIOS.SP_109I_NVO_USR(?,?,?,?,?)}

getComboTipoConsultaSwift = {call PG_XX_USUARIOS.SP_109S_COM_TPC(?)}

getComboUsuariosSwiftActivos = {call PG_XX_USUARIOS.SP_109S_COM_ACT(?)}
					 
getComboUsuariosSwiftNuevos = {call PG_XX_USUARIOS.SP_109S_COM_NEW(?)}
							 
getComboUsuariosSwiftBaja =  {call PG_XX_USUARIOS.SP_109S_COM_BAJ(?)}
                         
getUsuariosSwiftActivos = {call PG_XX_USUARIOS.SP_109S_USR_ACT(?,?)}

		        
getUsuariosSwiftBaja = {call PG_XX_USUARIOS.SP_109S_USR_BAJ(?,?)}
				        
				        
getUsuariosSwiftNuevos = {call PG_XX_USUARIOS.SP_109S_USR_NEW(?,?)}


getTipoConsultaSwift = {call PG_XX_USUARIOS.SP_109S_COM_TPC(?)}


deleteUsuariosSwift =  {call PG_XX_USUARIOS.SP_109D_DEL_USR}

###########################PERFILES####################################################################333
insertPerfiles = {call PG_XX_PERFILES.SP_110I_SEG_PRFSAA(?,?,?,?,?)}

getComboPerfilesSwift = {call PG_XX_PERFILES.SP_110S_COM_PERF(?)}

getPerfilesSwift = {call PG_XX_PERFILES.SP_110S_CSTA_PER(?,?)}

deletePerfilesSwift = {call PG_XX_PERFILES.SP_110D_DEL_PERF}

getBicPais = select NB_BIC FROM TGM006_PAIS WHERE NB_PAIS = ?

#Se agrega un nuevo query para obtener los formatos de MT101 con la propiedad 'with (nolock)' para no bloquear las tuplas
getUrlFormatosMT101=select * from MACUG_FACT_TIPO_FORMATO_MT101 with (noLock)  where id_pais=? 
					
getUrlFormatosMT101Cliente=Select * from MACUG_FACT_TIPO_FORMATO_MT101 with (noLock)  where id_pais=? \
					and id_tipo_formato in (select id_tipo_formato from MACUG_FACT_CTE_FORMATO_MT101 \
					where id_cliente=?)					
					
insertUrlFormatos=Insert into MACUG_FACT_CTE_FORMATO_MT101 (id_cliente,id_tipo_formato) values (?,?)

updateUrlFormato=Update MACUG_FACT_CTE_FORMATO_MT101 set id_tipo_formato=? \
						 where id_cliente=? and id_tipo_formato=?
						 
#Se agrega una nueva consulta para verificar si un requetimiento contiene puntuacion

verificaPuntuacion= Select * from tgm071_puntuacion  WHERE CD_REQUERIMIENTO = ?
						 



#QUERYS CONSULTAS PANTALLA ALTA DE SERVICIOS
# Query de Consulta REEMPLAZA AL PROCEDURE: spr_MacugH2H_CatContratoServicios(?)
consultaEnvioArchivosXCvePais = SELECT TP.NB_PAIS PAIS,  \
									    THSF.CD_CONTRATO CONTRATO,  \
									    THSF.CD_SERVICIO SERVICIO,  \
									    THSF.CD_SUBSERVICIO SUBSERVICIO, \
									    THSF.CD_BIC_ENVIO BICENVIO,\
									    (CASE WHEN THSF.NB_ARCH_REEMPLAZAR  IS NULL THEN ' ' ELSE THSF.NB_ARCH_REEMPLAZAR END) NB_ARCH_REEMPLAZAR, \
									    TO_CHAR (THSF.TM_ALTA, 'dd-MM-YYYY') FECHAALTA  \
									FROM TGM124_H2H_SRVFACT THSF  \
										     INNER JOIN TGM006_PAIS TP ON  THSF.CD_PAIS = TP.CD_PAIS  
										       
                                         
					
# Query de consulta que reemplaza al PROCEDURE: spr_MacugH2H_ArchivosContratoServicio()
## Revisar si realmente se utiliza.... existe duplicado en FileActGenericDao pero no se usa. el bueno es H2HEnvioArchivoDaoImpl
## consultaEnvioArchivos = SELECT (CASE WHEN A.NB_ARCHIVO_RENOMBR IS NULL THEN ' ' ELSE A.NB_ARCHIVO_RENOMBR END) NOMBRE_REEMPLAZO, \
##         TO_CHAR (A.FH_PROCESO, 'dd-MM-YYYY') FECHA_PROCESO,  \
##         TO_CHAR (A.TM_PROCESO,'HH:SS') HORA_PROCESO, \
##         B.NB_H2H_ST_ARCHIVO STATUS, \
##         A.CD_H2H_ST_ARCHIVO ID_STATUS_ENVIO, \
##         (CASE WHEN P.NB_PAIS IS NULL THEN ' ' ELSE P.NB_PAIS END) PAIS, \
##         (CASE WHEN C.CD_BIC_ENVIO IS NULL THEN ' ' ELSE C.CD_BIC_ENVIO END)  BIC_ENVIO, \
##         (CASE WHEN C.CD_SERVICIO  IS NULL THEN ' ' ELSE C.CD_SERVICIO END )  SERVICIO, \
##         A.NB_ARCHIVO NOMBRE_ORIGINAL,\
##         A.NB_ARCHIVO NOMBRE_COMPLETO \
## FROM TGM125_H2H_ENVFACT A,  \
##      TGM123_H2H_ST_ARCH B,  \
 ##     TGM124_H2H_SRVFACT C,  \
  ##    TGM006_PAIS P \ falta filtro por nombre y por servicio
consultaEnvioArchivos= SELECT * FROM ( \
    SELECT DISTINCT NVL(A.NB_ARCHIVO_RENOMBR, ' ') NOMBRE_REEMPLAZO, TO_CHAR(A.FH_PROCESO, 'dd-MM-YYYY') FECHA_PROCESO, \
      TO_CHAR(A.TM_PROCESO,'HH:SS') HORA_PROCESO, B.NB_H2H_ST_ARCHIVO STATUS, A.CD_H2H_ST_ARCHIVO ID_STATUS_ENVIO, \
      NVL(P.NB_PAIS, ' ') PAIS, NVL(C.CD_BIC_ENVIO, ' ') BIC_ENVIO, NVL(C.CD_SERVICIO, ' ') SERVICIO, \
      A.NB_ARCHIVO NOMBRE_ORIGINAL, A.NB_ARCHIVO NOMBRE_COMPLETO, NVL(C.CD_CONTRATO, ' ') CD_CONTRATO \
    FROM TGM125_H2H_ENVFACT A  \
    INNER JOIN TGM123_H2H_ST_ARCH B ON A.CD_H2H_ST_ARCHIVO = B.CD_H2H_ST_ARCHIVO  \
    LEFT OUTER JOIN TGM124_H2H_SRVFACT C ON A.CD_H2H_SRVFACT = C.CD_H2H_SRVFACT  \
    LEFT OUTER JOIN TGM006_PAIS P ON C.CD_PAIS = P.CD_PAIS  \
    WHERE A.TM_PROCESO >= TO_DATE(?, 'DD/MM/YYYY')  \
    AND A.TM_PROCESO <= TO_DATE(?, 'DD/MM/YYYY') \
      AND RTRIM(SUBSTR(A.NB_ARCHIVO, 35, 7)) LIKE '%' || ? || '%' \
      AND A.NB_ARCHIVO LIKE '%' || ? || '%' \
      AND B.CD_H2H_ST_ARCHIVO LIKE   ?   \
) TOT \
WHERE TOT.BIC_ENVIO LIKE	'%' || ? || '%' \
AND TOT.CD_CONTRATO LIKE '%' || ? || '%' \
AND TOT.SERVICIO LIKE '%' || ? || '%' \
AND TOT.PAIS LIKE '%' || ? || '%'
							
									 
# Modificacion de queries para CATALOGOS-> FILEACT->ALTA SERVICIOS
#Este est en Bitacora YA ESTA EL PROCEDIMIENTO en PG_MX_PAGOS_H2H.SP_006S_CD_PAIS(?,?)
obtenerCdPaisXNombre = SELECT CD_PAIS FROM TGM006_PAIS WHERE NB_PAIS = ?

# Query que reemplaza el PROCEDURE: spr_MacugFact_ObtenerCvePaisXCdPais
 # YA EXISTE PROCEDIMIENTO SE LLAMA SP_006S_CDPAIS_CDP
obtieneCvePaisXCdPais = SELECT (CASE WHEN NB_PAIS IS NULL THEN '' ELSE NB_PAIS END) CLAVEPAIS \
						 FROM TGM006_PAIS \
						WHERE CD_PAIS =	? 
						 
#Query que reemplaza al PROCEDURE: spr_MacugFact_CatPais
# YA EXISTE PROCEDIMIENTO SE LLAMA SP_006S_PAISES
obtienePaises = SELECT  (CASE WHEN CD_PAIS IS NULL THEN 0 ELSE CD_PAIS END)  ID_PAIS, \
				        (CASE WHEN TX_PAIS IS NULL THEN '' ELSE NB_PAIS||' - '||TX_PAIS END) DESCRIPCION, \
				        (CASE WHEN NB_PAIS IS NULL THEN '' ELSE NB_PAIS END) CLAVEPAIS \
				 FROM TGM006_PAIS \
				 ORDER BY 2,3
				 
#Query que reemplaza al PROCEDURE: spr_MacugH2H_ValidaContratoServicios
# PROCEDIMIENTO YA EXISTE SE LLAMA SP_124S_VALIDASERVICIO
validaContratosServicios = SELECT TP.NB_PAIS       PAIS, \
							       THSF.CD_CONTRATO CONTRATO, \
							       THSF.CD_SERVICIO SERVICIO, \
							       THSF.CD_SUBSERVICIO SUBSERVICIO \
							 FROM TGM124_H2H_SRVFACT THSF \
								  INNER JOIN TGM006_PAIS TP \
								          ON  THSF.CD_PAIS = TP.CD_PAIS \
							WHERE       TP.NB_PAIS        =  ? \
								  AND THSF.CD_CONTRATO    =  ? \
								  AND THSF.CD_SERVICIO    =  ? \
								  AND THSF.CD_SUBSERVICIO =  ? \
								  
# ya existe el procedure se llama SP_124S_CTO_ACTIVO								   
isContratoServicioActivo = SELECT THSF.CD_ACTIVO \
							  FROM TGM124_H2H_SRVFACT THSF \
							WHERE THSF.CD_PAIS    =  ? \
								  AND THSF.CD_CONTRATO    =  ? \
								  AND THSF.CD_SERVICIO    =  ? \
								  AND THSF.CD_SUBSERVICIO =  ? 
								  
								  
  # Ya existe el procedure se llama  SP_124S_CD_SRVFACT
obtieneServicio =   SELECT CD_H2H_SRVFACT \
					FROM TGM124_H2H_SRVFACT \
					WHERE CD_PAIS = ? AND CD_CONTRATO = ? \
					AND CD_SERVICIO= ? AND CD_SUBSERVICIO =?
					
 #CRUD para contratos - Servicios
 ## YA EXISTE EL PROCEDURE SP_124I_SERVCNTO
insertaServicios = INSERT INTO TGM124_H2H_SRVFACT(CD_PAIS,  \
 					CD_CONTRATO, CD_SERVICIO, CD_SUBSERVICIO,  \
 					CD_BIC_ENVIO, NB_ARCH_REEMPLAZAR, CD_USUARIO,TM_ALTA,  \
 					TM_MODIFICACION,  CD_ACTIVO)  \
  					VALUES( ?,?,?,?,?,?,?,SYSDATE,SYSDATE,1)
## YA EXISTE EL PROCEDURE SP_124U_SERVCNTO  					
actualizaServicios = UPDATE TGM124_H2H_SRVFACT \
				     SET CD_PAIS=?, CD_CONTRATO=?, \
				     CD_SERVICIO=?, CD_SUBSERVICIO=?, CD_BIC_ENVIO=?, \
				     NB_ARCH_REEMPLAZAR=?, TM_MODIFICACION=SYSDATE \
				     WHERE CD_PAIS = ?  AND CD_CONTRATO = ?  \
				     AND CD_SERVICIO = ? AND  CD_SUBSERVICIO = ?
## YA EXISTE EL PROCEDURE SP_124U_ELIMINA  					
				     
actualizaStatusServicios =   UPDATE TGM124_H2H_SRVFACT \
				     SET CD_ACTIVO= ? \
				     WHERE CD_PAIS = ?   AND CD_CONTRATO = ?  \
				     AND CD_SERVICIO = ? AND  CD_SUBSERVICIO = ?	
				     
## YA EXISTE EL PROCEDURE SP_124U_REACTIVA  					
     		
reactivaServicio = UPDATE TGM124_H2H_SRVFACT SET CD_ACTIVO =? \
					WHERE CD_H2H_SRVFACT = ?  					
#Query de insercion en la tabla de procesos.
#Existe ya el procedure Se llama SP_107I_EVENTO_WEB
insertaProcesosWeb = INSERT INTO TGM107_EVENTO_WEB(CD_USUARIO, \
                     TX_EVENTO_WEB, TM_EVENTO_WEB)  \
                     VALUES(?, ?, SYSDATE)

#Existe este procedimiento se llama SP_107S_EVENTO_WEB                     
obtieneProcesosWeb = SELECT TX_EVENTO_WEB,TM_EVENTO_WEB \
 					  FROM TGM107_EVENTO_WEB
 					  
 					  
#Querys para H2H
#1. Pantalla Bitacora H2H
sqlCmdBitacoraH2H= SELECT    \
            (CASE   WHEN pl.TX_PROCESO_LOG LIKE '%Archivo de H2H%'      THEN 'Respuestas' \
                    WHEN pl.TX_PROCESO_LOG LIKE '%Archivo de Respuesta%' THEN 'Respuestas' \
                    WHEN pl.TX_PROCESO_LOG LIKE '%Archivo de Entrada%' THEN 'Entrada'\
                    ELSE ' ' END) tipo_flujo, \
             p.NB_PAIS , \
             pl.TX_PROCESO_LOG, \
		     TO_CHAR(pl.TM_PROCESO_LOG, 'DD-MM-YYYY HH:MM:SS') TM_PROCESO_LOG  \
			        FROM TGM048_PROCESO_LOG pl \ INNER JOIN TGM047_TP_EVENTO   te ON pl.CD_TP_EVENTO = te.CD_TP_EVENTO  \
			  INNER JOIN TGM033_PROCESO_GIS pg ON pl.CD_PROCESO_GIS = pg.CD_PROCESO_GIS \
			  INNER JOIN TGM006_PAIS p ON pg.CD_PAIS = p.CD_PAIS 
			  

			         	
#2. Consulta de valores de la tabla de parametros
# este tambien pasa a un procedure: SP_046S_PARAMETROS
consultaTablaParametros = SELECT * \
							FROM TGM046_PARAM_CFG  \
								WHERE CD_PROCESO_GIS  \
								IN (SELECT CD_PROCESO_GIS FROM TGM033_PROCESO_GIS WHERE NB_PROCESO_GIS = ?) \
							 AND NB_PARAM_CFG = ?
					   
#QUERYS PARA PANTALLA ENVIOSWNET
#consultaRecepcionArchivos = SELECT TO_CHAR(A.FH_PROCESO, 'DD-MM-YYYY') FECHA_PROCESO, TO_CHAR(A.TM_PROCESO, 'HH:MM:SS') HORA_PROCESO, \
#						    A.NB_ARCHIVO NOMBRE_ARCHIVO,  \
#      						(CASE WHEN C.CD_BIC_ENVIO IS NULL THEN ' ' ELSE C.CD_BIC_ENVIO END) CD_BIC_ENVIO, \
#     						B.NB_H2H_ST_ARCHIVO  EVENTO  \
#    						FROM   TGM125_H2H_ENVFACT A  \
#       						, TGM123_H2H_ST_ARCH B,TGM124_H2H_SRVFACT C \
#       						WHERE    \
#       						A.CD_H2H_ST_ARCHIVO = B.CD_H2H_ST_ARCHIVO  (+) \
##       						AND A.CD_H2H_SRVFACT = C.CD_H2H_SRVFACT (+) \#
#       						AND A.CD_H2H_ENVFACT \
#       						IN (SELECT CD_H2H_ENVFACT FROM TGM125_H2H_ENVFACT WHERE TO_DATE(TO_CHAR(TM_PROCESO, 'DD-MM-YYYY'),'DD-MM-YYYY') BETWEEN TO_DATE(?, 'DD-MM-YYYY') \
#       						AND TO_DATE(?, 'DD-MM-YYYY')) \
#       						AND RTRIM(SUBSTR(A.NB_ARCHIVO,6,8)) LIKE ? \
#       						AND RTRIM(SUBSTR(A.NB_ARCHIVO,35,7))LIKE ? \
#       						AND RTRIM(A.NB_ARCHIVO) LIKE ? 
       						  

#consultaRecepcionArchivosUnion= UNION \
#       						SELECT TO_CHAR(A.FH_PROCESO, 'DD-MM-YYYY') FECHA_PROCESO, TO_CHAR(A.TM_PROCESO, 'HH:MM:SS') HORA_PROCESO, \
#       						A.NB_ARCHI_PROCESADO NOMBRE_ARCHIVO, \
#       						(CASE WHEN A.CD_BIC IS NULL THEN ' ' ELSE A.CD_BIC END) CD_BIC_ENVIO, \
#       						B.NB_H2H_ST_ARCHIVO  EVENTO \
##       						FROM TGM121_H2H_ARCHIVO A, TGM123_H2H_ST_ARCH B \
#    						WHERE A.CD_H2H_ST_ARCHIVO = B.CD_H2H_ST_ARCHIVO \
#    						AND B.CD_TP_FLUJO = 'O' \
#    						AND TO_DATE(TO_CHAR(TM_PROCESO, 'DD-MM-YYYY'),'DD-MM-YYYY') BETWEEN TO_DATE(?, 'DD-MM-YYYY') \
#    						AND TO_DATE(?, 'DD-MM-YYYY') \
#    						AND RTRIM(SUBSTR(A.NB_ARCHI_PROCESADO,6,8)) LIKE ? \
#    						AND RTRIM(SUBSTR(A.NB_ARCHI_PROCESADO,35,7))LIKE ?  \
#    						AND RTRIM(A.NB_ARCHI_PROCESADO) LIKE ?					        


consultaRecepcionArchivos= SELECT * FROM(  \
  SELECT TO_CHAR(A.FH_PROCESO, 'DD-MM-YYYY') FECHA_PROCESO, TO_CHAR(A.TM_PROCESO, 'HH:MM:SS') HORA_PROCESO, \
    A.NB_ARCHIVO NOMBRE_ARCHIVO, NVL(C.CD_BIC_ENVIO, ' ') CD_BIC_ENVIO, B.NB_H2H_ST_ARCHIVO EVENTO \
  FROM TGM125_H2H_ENVFACT A, TGM123_H2H_ST_ARCH B, TGM124_H2H_SRVFACT C \
  WHERE A.CD_H2H_ST_ARCHIVO = B.CD_H2H_ST_ARCHIVO (+) \
    AND A.CD_H2H_SRVFACT = C.CD_H2H_SRVFACT (+) \
    AND A.CD_H2H_ENVFACT IN (SELECT CD_H2H_ENVFACT \
      FROM TGM125_H2H_ENVFACT  \
      WHERE TRUNC(TM_PROCESO, 'DD') BETWEEN TO_DATE(?, 'DD-MM-YYYY') AND TO_DATE(?, 'DD-MM-YYYY')) \
    AND RTRIM(SUBSTR(A.NB_ARCHIVO, 6, 8)) LIKE '%' || ? || '%' \
    AND RTRIM(SUBSTR(A.NB_ARCHIVO, 35, 7)) LIKE '%' || ? || '%' \
    AND RTRIM(A.NB_ARCHIVO) LIKE '%' || ? || '%') TOT \
WHERE TOT.CD_BIC_ENVIO LIKE '%' || ? || '%' \
UNION \
SELECT TO_CHAR(A.FH_PROCESO, 'DD-MM-YYYY') FECHA_PROCESO, TO_CHAR(A.TM_PROCESO, 'HH:MM:SS') HORA_PROCESO, \
  A.NB_ARCHI_PROCESADO NOMBRE_ARCHIVO, NVL(A.CD_BIC, '') CD_BIC_ENVIO, B.NB_H2H_ST_ARCHIVO EVENTO \
FROM TGM121_H2H_ARCHIVO A, TGM123_H2H_ST_ARCH B  \
WHERE A.CD_H2H_ST_ARCHIVO = B.CD_H2H_ST_ARCHIVO \
  AND B.CD_TP_FLUJO = 'O' \
  AND TRUNC(TM_PROCESO, 'DD') BETWEEN TO_DATE(?, 'DD-MM-YYYY') AND TO_DATE(?, 'DD-MM-YYYY') \
  AND RTRIM(SUBSTR(A.NB_ARCHI_PROCESADO, 6, 8)) LIKE '%' || ? || '%' \
  AND RTRIM(SUBSTR(A.NB_ARCHI_PROCESADO, 35, 7)) LIKE '%' || ? || '%' \
  AND RTRIM(A.NB_ARCHI_PROCESADO) LIKE '%' || ? || '%' \
  AND A.CD_BIC LIKE '%' || ? || '%'
  
  
#QUERYS PANTALLA ENVIO ARCHIVOS H2H
# Ya existe el procedimiento se llama SP_124S_EXISTECTO

validaContratosServicios = SELECT TP.NB_PAIS       PAIS, \
							       THSF.CD_CONTRATO CONTRATO, \
							       THSF.CD_SERVICIO SERVICIO, \
							       THSF.CD_SUBSERVICIO SUBSERVICIO \
							 FROM TGM124_H2H_SRVFACT THSF \
								  INNER JOIN TGM006_PAIS TP \
								          ON  THSF.CD_PAIS = TP.CD_PAIS \
							WHERE       TP.NB_PAIS        =  ? \
								  AND THSF.CD_CONTRATO    =  ? \
								  AND THSF.CD_SERVICIO    =  ? \
								  AND THSF.CD_SUBSERVICIO =  ?
								  
								  
obtieneEstatus = SELECT CD_H2H_ST_ARCHIVO id_status, \
				        NB_H2H_ST_ARCHIVO descripcionStatus, \
				        CD_TP_FLUJO       tipoFlujo \
				 FROM  TGM123_H2H_ST_ARCH  \
				 WHERE CD_TP_FLUJO = 'O' \
				 ORDER BY NB_H2H_ST_ARCHIVO	 								  
	
#2. Consulta de valores de la tabla de parametros
consultaParametroGIS = SELECT CD_PROCESO_GIS \
					   FROM TGM046_PARAM_CFG \
					   WHERE NB_PARAM_CFG ='PRC_MX_PAGOS_H2H'						 
					   
##################### MONITOREO MULTICANAL MT94X ##################

consultaOpsProcesadasMT940 =     SELECT T027_2.NB_CAMPO_25       AS NUMERO_CUENTA, \
								 T132.NB_CLIENTE_RELAY  AS NOMBRE_CLIENTE, \
								 T027_2.NB_BUZON          AS BUZON_CW_H2H, \
								 T027_2.NB_CONTRATO       AS REFERENCIA_CW_H2H, \
								 T132.CD_REFERENCIA_BNC AS REFERENCIA_BNC, \
								 TO_CHAR(T027_2.FH_PROCESO,'DD/MM/YYYY') AS FECHA_RECEPCION_SAA, \
								 TO_CHAR(T027_2.TM_PROCESO,'hh24:mi')    AS HORA_RECEPCION_SAA, \
								 T027_2.CD_BIC_ORIGEN AS BIC_PROCEDENCIA, \
								 T027_2.NB_CAMPO_20   AS CAMPO_20, \
								 T027_2.NB_CAMPO_21   AS CAMPO_21, \
								 T027_2.NB_CAMPO_25   AS CAMPO_25, \
								 TO_CHAR(T027_2.NB_CAMPO_28C_NUM,'FM00000')||'/'||TO_CHAR(T027_2.NB_CAMPO_28C_PAG,'FM00000')   AS CAMPO_28, \
								 T027_2.NB_CAMPO_60_DC ||TO_CHAR(T027_2.FH_CAMPO_60A,'YYMMDD')||T027_2.CD_CAMPO_60A_MNDA|| TRIM(TO_CHAR(TO_NUMBER(T027_2.IM_CAMPO_60A_MONTO),'9999999999999990D00')) AS CAMPO_60, \
								 T027_2.NB_CAMPO_62_DC ||TO_CHAR(T027_2.FH_CAMPO_62A,'YYMMDD')||T027_2.CD_CAMPO_62A_MNDA|| TRIM(TO_CHAR(TO_NUMBER(T027_2.IM_CAMPO_62A_MONTO),'9999999999999990D00')) AS CAMPO_62, \
								 T027_2.NB_CAMPO_64_DC || TO_CHAR(T027_2.FH_CAMPO_64,'YYMMDD')||T027_2.CD_CAMPO_64_MNDA || TRIM(TO_CHAR(TO_NUMBER(T027_2.IM_CAMPO_64_MONTO),'9999999999999990D00'))  AS CAMPO_64 \
								 ,T034.NB_CAMPO_65_DC|| TO_CHAR(T034.FH_CAMPO_65,'YYMMDD')||T034.CD_CAMPO_65_MNDA || TRIM(TO_CHAR(TO_NUMBER(T034.IM_CAMPO_65_MONTO),'9999999999999990D00')) AS CAMPO_65 \
					FROM  TGM132_CTARL_MX94X T132 \
					INNER JOIN (SELECT * FROM TGM027_MT940  T027 \
											INNER JOIN (SELECT NB_CUENTA, NB_CONTRATO, NB_BUZON FROM TGM040_CTA_RLY_MX) T040 \
											ON T027.NB_CAMPO_25 = T040.NB_CUENTA \
											WHERE FH_PROCESO BETWEEN TO_DATE (?,'DD/MM/YYYY') AND TO_DATE (?,'DD/MM/YYYY') \
											AND NB_CAMPO_25 LIKE '%' || ? || '%' \
											AND NB_CAMPO_20 LIKE '%' || ? || '%'  \
											AND NB_CONTRATO LIKE '%' || ? || '%'  \
											AND NB_BUZON LIKE '%' || ? || '%' \
											) T027_2 		ON T132.NB_CUENTA = T027_2.NB_CAMPO_25 LEFT JOIN TGM034_MT940_65 T034 ON T034.CD_SECUENCIA_A = T027_2.CD_SECUENCIA_A \
					WHERE T132.CD_MT940 = 1  \
					AND T132.CD_REFERENCIA_BNC IS NOT NULL \
					AND T132.CD_REFERENCIA_BNC LIKE '%' || ? ||'%' \
					ORDER BY T132.CD_REFERENCIA_BNC, NUMERO_CUENTA, CAMPO_28  
						 
totalOperacionesProcesadasMT940	= SELECT COUNT(T027.NB_CAMPO_25) AS TOTAL_OPERACIONES_MT940 \
								  FROM (SELECT * FROM TGM040_CTA_RLY_MX \
										            WHERE NB_CONTRATO LIKE '%' || ? || '%' \
													  AND NB_BUZON LIKE '%' || ? || '%' \
															 ) T040 \
										INNER JOIN (SELECT * FROM TGM027_MT940 \
											 WHERE FH_PROCESO BETWEEN TO_DATE (?,'DD/MM/YYYY') AND TO_DATE (?,'DD/MM/YYYY') \
											 AND NB_CAMPO_25 LIKE '%' || ? || '%' \
											 AND NB_CAMPO_20 LIKE '%' || ? || '%' \
											) T027 ON T040.NB_CUENTA = T027.NB_CAMPO_25 \
										INNER JOIN TGM132_CTARL_MX94X T132 ON T027.NB_CAMPO_25 = T132.NB_CUENTA \
										INNER JOIN TGM034_MT940_65 T034 ON T034.CD_SECUENCIA_A = T027.CD_SECUENCIA_A \
													AND T132.CD_MT940 = 1 \
													AND T132.CD_REFERENCIA_BNC IS NOT NULL \
													AND T132.CD_REFERENCIA_BNC LIKE '%' || ? ||'%' 							