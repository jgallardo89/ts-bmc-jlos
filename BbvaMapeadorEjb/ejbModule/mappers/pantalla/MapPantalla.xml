<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="mappers.pantalla.MapPantalla">
	<select id="obtenerPantallas" parameterType="mx.com.bbva.bancomer.bussinnes.model.vo.PantallaVO"
		resultType="mx.com.bbva.bancomer.bussinnes.model.vo.PantallaVO">
		SELECT 
			P.CD_PANTALLA idPantalla, 
			P.CD_FK_PANTALLA idPantallaPadre,  
			P.NB_PANTALLA nombrePantalla, 
			P.TX_URL_PANTALLA descripcionUrlPantalla, 
			P.TX_URL_ICON descripcionUrlIcon, 
			P.NU_ORD_PANTALLA numeroOrdenPantalla, 
			P.ST_PANTALLA estatusPantalla, 
			PD.NB_PANTALLA nombrePantallaPadre,
			O.NB_ST_OBJETO AS nombreEstatusObjeto
		FROM 
			TGM501_PANTALLA P,
			TGM501_PANTALLA PD,
			TGM534_ST_OBJETO O
		WHERE 
		    PD.CD_PANTALLA = P.CD_FK_PANTALLA AND
			P.ST_PANTALLA = O.CD_ST_OBJETO
			
			<if test="idPantallaPadre != null and idPantallaPadre != 0">
				AND P.CD_FK_PANTALLA = #{idPantallaPadre}
			</if>
			<if test="nombrePantalla != null">
				AND P.NB_PANTALLA LIKE #{nombrePantalla}
			</if>
			<if test="descripcionUrlPantalla != null ">
				AND P.TX_URL_PANTALLA LIKE #{descripcionUrlPantalla}
			</if>						  
			<if test="descripcionUrlIcon != null ">
				AND  P.TX_URL_ICON LIKE #{descripcionUrlIcon}
			</if>		 
			<if test="numeroOrdenPantalla != null and numeroOrdenPantalla != 0">
				AND  P.NU_ORD_PANTALLA = #{numeroOrdenPantalla}
			</if>
			<if test="estatusPantalla != null and estatusPantalla != 0">
				AND  P.ST_PANTALLA = #{estatusPantalla}
			</if>	
				ORDER BY P.CD_PANTALLA
	</select>
	<insert id="crearPantalla" keyProperty="idPantalla" parameterType="mx.com.bbva.bancomer.bussinnes.model.vo.PantallaVO">
		<selectKey keyProperty="idPantalla" resultType="int" order="BEFORE"> 
			<![CDATA[ select SQ_PANTALLA.nextval as idPantalla from dual ]]> 
		</selectKey>
			INSERT INTO TGM501_PANTALLA (
			CD_PANTALLA, 
			CD_FK_PANTALLA, 
			NB_PANTALLA, 
			TX_URL_PANTALLA, 
			TX_URL_ICON, 
			NU_ORD_PANTALLA,
			ST_PANTALLA) VALUES (
			#{idPantalla}, 
			#{idPantallaPadre},  
			#{nombrePantalla}, 
			#{descripcionUrlPantalla}, 
			#{descripcionUrlIcon}, 
			#{numeroOrdenPantalla}, 
			#{estatusPantalla})
	</insert>
	<update id="actualizarPantalla" parameterType="mx.com.bbva.bancomer.bussinnes.model.vo.PantallaVO">
		UPDATE TGM501_PANTALLA SET  
			CD_FK_PANTALLA = #{idPantallaPadre}, 
			NB_PANTALLA = #{nombrePantalla}, 
			TX_URL_PANTALLA = #{descripcionUrlPantalla}, 
			TX_URL_ICON = #{descripcionUrlIcon}, 
			NU_ORD_PANTALLA = #{numeroOrdenPantalla},  
			ST_PANTALLA = #{estatusPantalla}
		WHERE 
		CD_PANTALLA = #{idPantalla}
	</update>
</mapper>